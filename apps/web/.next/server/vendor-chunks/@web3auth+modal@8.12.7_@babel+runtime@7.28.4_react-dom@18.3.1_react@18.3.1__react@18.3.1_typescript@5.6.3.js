"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@web3auth+modal@8.12.7_@babel+runtime@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1_typescript@5.6.3";
exports.ids = ["vendor-chunks/@web3auth+modal@8.12.7_@babel+runtime@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1_typescript@5.6.3"];
exports.modules = {

/***/ "(ssr)/../../node_modules/.pnpm/@web3auth+modal@8.12.7_@babel+runtime@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1_typescript@5.6.3/node_modules/@web3auth/modal/dist/modal.esm.js":
/*!*****************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/@web3auth+modal@8.12.7_@babel+runtime@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1_typescript@5.6.3/node_modules/@web3auth/modal/dist/modal.esm.js ***!
  \*****************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Web3Auth: () => (/* binding */ Web3Auth),\n/* harmony export */   defaultEvmDappModalConfig: () => (/* binding */ defaultEvmDappModalConfig),\n/* harmony export */   defaultEvmWalletModalConfig: () => (/* binding */ defaultEvmWalletModalConfig),\n/* harmony export */   defaultOtherModalConfig: () => (/* binding */ defaultOtherModalConfig),\n/* harmony export */   defaultSolanaDappModalConfig: () => (/* binding */ defaultSolanaDappModalConfig),\n/* harmony export */   defaultSolanaWalletModalConfig: () => (/* binding */ defaultSolanaWalletModalConfig)\n/* harmony export */ });\n/* harmony import */ var _web3auth_base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @web3auth/base */ \"(ssr)/../../node_modules/.pnpm/@web3auth+base@8.12.4_@babel+runtime@7.28.4/node_modules/@web3auth/base/dist/base.esm.js\");\n/* harmony import */ var _babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/objectSpread2 */ \"(ssr)/../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/objectSpread2.js\");\n/* harmony import */ var _babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"(ssr)/../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/defineProperty.js\");\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _web3auth_base_provider__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @web3auth/base-provider */ \"(ssr)/../../node_modules/.pnpm/@web3auth+base-provider@8.12.4_@babel+runtime@7.28.4/node_modules/@web3auth/base-provider/dist/baseProvider.esm.js\");\n/* harmony import */ var _web3auth_no_modal__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @web3auth/no-modal */ \"(ssr)/../../node_modules/.pnpm/@web3auth+no-modal@8.12.4_@babel+runtime@7.28.4_@web3auth+openlogin-adapter@8.12.4_@babel+runtime@7.28.4_/node_modules/@web3auth/no-modal/dist/noModal.esm.js\");\n/* harmony import */ var _web3auth_openlogin_adapter__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @web3auth/openlogin-adapter */ \"(ssr)/../../node_modules/.pnpm/@web3auth+openlogin-adapter@8.12.4_@babel+runtime@7.28.4/node_modules/@web3auth/openlogin-adapter/dist/openloginAdapter.esm.js\");\n/* harmony import */ var _web3auth_ui__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @web3auth/ui */ \"(ssr)/../../node_modules/.pnpm/@web3auth+ui@8.12.7_@babel+runtime@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1_typescript@5.6.3/node_modules/@web3auth/ui/dist/index.js\");\n/* harmony import */ var lodash_clonedeep__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! lodash.clonedeep */ \"(ssr)/../../node_modules/.pnpm/lodash.clonedeep@4.5.0/node_modules/lodash.clonedeep/index.js\");\n/* harmony import */ var lodash_clonedeep__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(lodash_clonedeep__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var lodash_merge__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! lodash.merge */ \"(ssr)/../../node_modules/.pnpm/lodash.merge@4.6.2/node_modules/lodash.merge/index.js\");\n/* harmony import */ var lodash_merge__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(lodash_merge__WEBPACK_IMPORTED_MODULE_8__);\n\n\n\n\n\n\n\n\n\n\nconst defaultSolanaDappModalConfig = {\n  chainNamespace: _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.CHAIN_NAMESPACES.SOLANA,\n  adapters: {\n    [_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.SOLANA_ADAPTERS.TORUS_SOLANA]: {\n      label: \"Torus Wallet\",\n      showOnModal: true,\n      showOnMobile: true,\n      showOnDesktop: true\n    },\n    [_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.SOLANA_ADAPTERS.OPENLOGIN]: {\n      label: \"OpenLogin\",\n      showOnModal: true,\n      showOnMobile: true,\n      showOnDesktop: true\n    },\n    [_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.SOLANA_ADAPTERS.PHANTOM]: {\n      label: \"Phantom\",\n      showOnModal: true,\n      showOnMobile: true,\n      showOnDesktop: true\n    }\n  }\n};\nconst defaultEvmDappModalConfig = {\n  chainNamespace: _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.CHAIN_NAMESPACES.EIP155,\n  adapters: {\n    [_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.EVM_ADAPTERS.TORUS_EVM]: {\n      label: \"Torus Wallet\",\n      showOnModal: true,\n      showOnMobile: true,\n      showOnDesktop: true\n    },\n    [_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.EVM_ADAPTERS.METAMASK]: {\n      label: \"MetaMask\",\n      showOnModal: true,\n      showOnMobile: true,\n      showOnDesktop: true\n    },\n    [_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.EVM_ADAPTERS.OPENLOGIN]: {\n      label: \"OpenLogin\",\n      showOnModal: true,\n      showOnMobile: true,\n      showOnDesktop: true\n    },\n    [_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.EVM_ADAPTERS.WALLET_CONNECT_V2]: {\n      label: \"Wallet Connect\",\n      showOnModal: true,\n      showOnMobile: true,\n      showOnDesktop: true\n    }\n  }\n};\nconst defaultSolanaWalletModalConfig = {\n  chainNamespace: _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.CHAIN_NAMESPACES.SOLANA,\n  adapters: {\n    [_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.SOLANA_ADAPTERS.OPENLOGIN]: {\n      label: \"OpenLogin\",\n      showOnModal: true,\n      showOnMobile: true,\n      showOnDesktop: true\n    }\n  }\n};\nconst defaultEvmWalletModalConfig = {\n  chainNamespace: _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.CHAIN_NAMESPACES.EIP155,\n  adapters: {\n    [_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.EVM_ADAPTERS.OPENLOGIN]: {\n      label: \"OpenLogin\",\n      showOnModal: true,\n      showOnMobile: true,\n      showOnDesktop: true\n    }\n  }\n};\nconst defaultOtherModalConfig = {\n  chainNamespace: _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.CHAIN_NAMESPACES.OTHER,\n  adapters: {\n    [_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.EVM_ADAPTERS.OPENLOGIN]: {\n      label: \"OpenLogin\",\n      showOnModal: true,\n      showOnMobile: true,\n      showOnDesktop: true\n    }\n  }\n};\n\nclass Web3Auth extends _web3auth_no_modal__WEBPACK_IMPORTED_MODULE_4__.Web3AuthNoModal {\n  constructor(options) {\n    super(options);\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_2___default()(this, \"loginModal\", void 0);\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_2___default()(this, \"options\", void 0);\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_2___default()(this, \"modalConfig\", defaultOtherModalConfig);\n    this.options = _babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()({}, options);\n    if (!this.options.uiConfig) this.options.uiConfig = {};\n    if (!this.coreOptions.privateKeyProvider) throw _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.WalletInitializationError.invalidParams(\"privateKeyProvider is required\");\n  }\n  setModalConfig(modalConfig) {\n    super.checkInitRequirements();\n    this.modalConfig = modalConfig;\n  }\n  async initModal(params) {\n    super.checkInitRequirements();\n    let projectConfig;\n    try {\n      projectConfig = await (0,_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.fetchProjectConfig)(this.options.clientId, this.options.web3AuthNetwork);\n    } catch (e) {\n      _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.log.error(\"Failed to fetch project configurations\", e);\n      throw _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.WalletInitializationError.notReady(\"failed to fetch project configurations\", e);\n    }\n    const {\n      whitelabel\n    } = projectConfig;\n    this.options.uiConfig = lodash_merge__WEBPACK_IMPORTED_MODULE_8___default()(lodash_clonedeep__WEBPACK_IMPORTED_MODULE_7___default()(whitelabel), this.options.uiConfig);\n    if (!this.options.uiConfig.defaultLanguage) this.options.uiConfig.defaultLanguage = (0,_web3auth_ui__WEBPACK_IMPORTED_MODULE_6__.getUserLanguage)(this.options.uiConfig.defaultLanguage);\n    if (!this.options.uiConfig.mode) this.options.uiConfig.mode = \"light\";\n    this.loginModal = new _web3auth_ui__WEBPACK_IMPORTED_MODULE_6__.LoginModal(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()({}, this.options.uiConfig), {}, {\n      adapterListener: this\n    }));\n    this.subscribeToLoginModalEvents();\n    const {\n      sms_otp_enabled: smsOtpEnabled,\n      whitelist\n    } = projectConfig;\n    if (smsOtpEnabled !== undefined) {\n      var _params;\n      const adapterConfig = {\n        [_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.WALLET_ADAPTERS.OPENLOGIN]: {\n          label: _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.WALLET_ADAPTERS.OPENLOGIN,\n          loginMethods: {\n            [_web3auth_openlogin_adapter__WEBPACK_IMPORTED_MODULE_5__.LOGIN_PROVIDER.SMS_PASSWORDLESS]: {\n              name: _web3auth_openlogin_adapter__WEBPACK_IMPORTED_MODULE_5__.LOGIN_PROVIDER.SMS_PASSWORDLESS,\n              showOnModal: smsOtpEnabled,\n              showOnDesktop: smsOtpEnabled,\n              showOnMobile: smsOtpEnabled\n            }\n          }\n        }\n      };\n      if (!((_params = params) !== null && _params !== void 0 && _params.modalConfig)) params = {\n        modalConfig: {}\n      };\n      params.modalConfig = lodash_merge__WEBPACK_IMPORTED_MODULE_8___default()(lodash_clonedeep__WEBPACK_IMPORTED_MODULE_7___default()(params.modalConfig), adapterConfig);\n    }\n    await this.loginModal.initModal();\n    const providedChainConfig = this.options.chainConfig;\n    // merge default adapters with the custom configured adapters.\n    const allAdapters = [...new Set([...Object.keys(this.modalConfig.adapters || {}), ...Object.keys(this.walletAdapters)])];\n    const adapterConfigurationPromises = allAdapters.map(async adapterName => {\n      var _this$modalConfig$ada, _params2, _this$modalConfig$ada2, _this$modalConfig$ada3;\n      // start with the default config of adapter.\n      let adapterConfig = ((_this$modalConfig$ada = this.modalConfig.adapters) === null || _this$modalConfig$ada === void 0 ? void 0 : _this$modalConfig$ada[adapterName]) || {\n        label: adapterName.split(\"-\").map(_web3auth_ui__WEBPACK_IMPORTED_MODULE_6__.capitalizeFirstLetter).join(\" \"),\n        showOnModal: true,\n        showOnMobile: true,\n        showOnDesktop: true\n      };\n\n      // override the default config of adapter if some config is being provided by the user.\n      if ((_params2 = params) !== null && _params2 !== void 0 && (_params2 = _params2.modalConfig) !== null && _params2 !== void 0 && _params2[adapterName]) {\n        adapterConfig = _babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()({}, adapterConfig), params.modalConfig[adapterName]);\n      }\n      this.modalConfig.adapters[adapterName] = adapterConfig;\n\n      // check if adapter is configured/added by user and exist in walletAdapters map.\n      const adapter = this.walletAdapters[adapterName];\n      _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.log.debug(\"adapter config\", adapterName, (_this$modalConfig$ada2 = this.modalConfig.adapters) === null || _this$modalConfig$ada2 === void 0 ? void 0 : _this$modalConfig$ada2[adapterName].showOnModal, adapter);\n\n      // if adapter is not custom configured then check if it is available in default adapters.\n      // and if adapter is not hidden by user\n      if (!adapter && (_this$modalConfig$ada3 = this.modalConfig.adapters) !== null && _this$modalConfig$ada3 !== void 0 && _this$modalConfig$ada3[adapterName].showOnModal) {\n        // Adapters to be shown on modal should be pre-configured.\n        if (adapterName === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.WALLET_ADAPTERS.OPENLOGIN) {\n          var _this$coreOptions$cha;\n          const defaultOptions = (0,_web3auth_openlogin_adapter__WEBPACK_IMPORTED_MODULE_5__.getOpenloginDefaultOptions)();\n          const {\n            clientId,\n            useCoreKitKey,\n            chainConfig,\n            web3AuthNetwork,\n            sessionTime,\n            privateKeyProvider\n          } = this.coreOptions;\n          const finalChainConfig = _babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()({}, (0,_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.getChainConfig)(providedChainConfig.chainNamespace, (_this$coreOptions$cha = this.coreOptions.chainConfig) === null || _this$coreOptions$cha === void 0 ? void 0 : _this$coreOptions$cha.chainId)), chainConfig);\n          if (!privateKeyProvider) {\n            throw _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.WalletInitializationError.invalidParams(\"privateKeyProvider is required\");\n          }\n          const finalOpenloginAdapterSettings = _babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()({}, defaultOptions.adapterSettings), {}, {\n            clientId,\n            network: web3AuthNetwork,\n            whiteLabel: this.options.uiConfig\n          });\n          if (smsOtpEnabled !== undefined) {\n            finalOpenloginAdapterSettings.loginConfig = {\n              [_web3auth_openlogin_adapter__WEBPACK_IMPORTED_MODULE_5__.LOGIN_PROVIDER.SMS_PASSWORDLESS]: {\n                showOnModal: smsOtpEnabled,\n                showOnDesktop: smsOtpEnabled,\n                showOnMobile: smsOtpEnabled,\n                showOnSocialBackupFactor: smsOtpEnabled\n              }\n            };\n          }\n          if (whitelist) {\n            finalOpenloginAdapterSettings.originData = whitelist.signed_urls;\n          }\n          if (this.options.uiConfig.uxMode) {\n            finalOpenloginAdapterSettings.uxMode = this.options.uiConfig.uxMode;\n          }\n          const openloginAdapter = new _web3auth_openlogin_adapter__WEBPACK_IMPORTED_MODULE_5__.OpenloginAdapter(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()({}, defaultOptions), {}, {\n            clientId,\n            useCoreKitKey,\n            chainConfig: _babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()({}, finalChainConfig),\n            adapterSettings: finalOpenloginAdapterSettings,\n            sessionTime,\n            web3AuthNetwork,\n            privateKeyProvider\n          }));\n          this.walletAdapters[adapterName] = openloginAdapter;\n          return adapterName;\n        }\n        throw _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.WalletInitializationError.invalidParams(`Adapter ${adapterName} is not configured`);\n      } else if ((adapter === null || adapter === void 0 ? void 0 : adapter.type) === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_CATEGORY.IN_APP || (adapter === null || adapter === void 0 ? void 0 : adapter.type) === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_CATEGORY.EXTERNAL || adapterName === this.cachedAdapter) {\n        var _this$modalConfig$ada4;\n        if (!((_this$modalConfig$ada4 = this.modalConfig.adapters) !== null && _this$modalConfig$ada4 !== void 0 && _this$modalConfig$ada4[adapterName].showOnModal)) return;\n        // add client id to adapter, same web3auth client id can be used in adapter.\n        // this id is being overridden if user is also passing client id in adapter's constructor.\n        this.walletAdapters[adapterName].setAdapterSettings({\n          clientId: this.options.clientId,\n          sessionTime: this.options.sessionTime,\n          web3AuthNetwork: this.options.web3AuthNetwork,\n          useCoreKitKey: this.coreOptions.useCoreKitKey\n        });\n\n        // if adapter doesn't have any chainConfig then we will set the chainConfig based of passed chainNamespace\n        // and chainNamespace.\n        if (!adapter.chainConfigProxy) {\n          var _this$coreOptions$cha2;\n          const chainConfig = _babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()({}, (0,_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.getChainConfig)(providedChainConfig.chainNamespace, (_this$coreOptions$cha2 = this.coreOptions.chainConfig) === null || _this$coreOptions$cha2 === void 0 ? void 0 : _this$coreOptions$cha2.chainId)), this.coreOptions.chainConfig);\n          this.walletAdapters[adapterName].setAdapterSettings({\n            chainConfig\n          });\n        }\n        if (adapterName === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.WALLET_ADAPTERS.OPENLOGIN) {\n          var _this$options$uiConfi;\n          const openloginAdapter = this.walletAdapters[adapterName];\n          if (this.coreOptions.privateKeyProvider) {\n            if (openloginAdapter.currentChainNamespace !== this.coreOptions.privateKeyProvider.currentChainConfig.chainNamespace) {\n              throw _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.WalletInitializationError.incompatibleChainNameSpace(\"private key provider is not compatible with provided chainNamespace for openlogin adapter\");\n            }\n            openloginAdapter.setAdapterSettings({\n              privateKeyProvider: this.coreOptions.privateKeyProvider\n            });\n          }\n          if (smsOtpEnabled !== undefined) {\n            openloginAdapter.setAdapterSettings({\n              loginConfig: {\n                [_web3auth_openlogin_adapter__WEBPACK_IMPORTED_MODULE_5__.LOGIN_PROVIDER.SMS_PASSWORDLESS]: {\n                  showOnModal: smsOtpEnabled,\n                  showOnDesktop: smsOtpEnabled,\n                  showOnMobile: smsOtpEnabled,\n                  showOnSocialBackupFactor: smsOtpEnabled\n                }\n              }\n            });\n          }\n          if (whitelist) {\n            openloginAdapter.setAdapterSettings({\n              originData: whitelist.signed_urls\n            });\n          }\n          if ((_this$options$uiConfi = this.options.uiConfig) !== null && _this$options$uiConfi !== void 0 && _this$options$uiConfi.uxMode) {\n            openloginAdapter.setAdapterSettings({\n              uxMode: this.options.uiConfig.uxMode\n            });\n          }\n          openloginAdapter.setAdapterSettings({\n            whiteLabel: this.options.uiConfig\n          });\n          if (!openloginAdapter.privateKeyProvider) {\n            throw _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.WalletInitializationError.invalidParams(\"privateKeyProvider is required for openlogin adapter\");\n          }\n        } else if (adapterName === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.WALLET_ADAPTERS.WALLET_CONNECT_V2) {\n          const walletConnectAdapter = this.walletAdapters[adapterName];\n          const {\n            wallet_connect_enabled: walletConnectEnabled,\n            wallet_connect_project_id: walletConnectProjectId\n          } = projectConfig;\n          if (walletConnectEnabled === false) {\n            var _this$modalConfig$ada5, _this$modalConfig$ada6, _this$modalConfig$ada7;\n            // override user specified config by hiding wallet connect\n            this.modalConfig.adapters = _babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()({}, (_this$modalConfig$ada5 = this.modalConfig.adapters) !== null && _this$modalConfig$ada5 !== void 0 ? _this$modalConfig$ada5 : {}), {}, {\n              [_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.WALLET_ADAPTERS.WALLET_CONNECT_V2]: _babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()({}, (_this$modalConfig$ada6 = (_this$modalConfig$ada7 = this.modalConfig.adapters) === null || _this$modalConfig$ada7 === void 0 ? void 0 : _this$modalConfig$ada7[_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.WALLET_ADAPTERS.WALLET_CONNECT_V2]) !== null && _this$modalConfig$ada6 !== void 0 ? _this$modalConfig$ada6 : {}), {}, {\n                showOnModal: false\n              })\n            });\n            this.modalConfig.adapters[_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.WALLET_ADAPTERS.WALLET_CONNECT_V2].showOnModal = false;\n          } else {\n            var _walletConnectAdapter;\n            if (!(walletConnectAdapter !== null && walletConnectAdapter !== void 0 && (_walletConnectAdapter = walletConnectAdapter.adapterOptions) !== null && _walletConnectAdapter !== void 0 && (_walletConnectAdapter = _walletConnectAdapter.adapterSettings) !== null && _walletConnectAdapter !== void 0 && (_walletConnectAdapter = _walletConnectAdapter.walletConnectInitOptions) !== null && _walletConnectAdapter !== void 0 && _walletConnectAdapter.projectId) && !walletConnectProjectId) throw _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.WalletInitializationError.invalidParams(\"Invalid wallet connect project id. Please configure it on the dashboard\");\n            if (walletConnectProjectId) {\n              walletConnectAdapter.setAdapterSettings({\n                adapterSettings: {\n                  walletConnectInitOptions: {\n                    projectId: walletConnectProjectId\n                  }\n                }\n              });\n            }\n          }\n        }\n        return adapterName;\n      }\n    });\n    const adapterNames = await Promise.all(adapterConfigurationPromises);\n    const hasInAppWallets = Object.values(this.walletAdapters).some(adapter => {\n      var _this$modalConfig$ada8, _this$modalConfig$ada9, _adapter$name;\n      if (adapter.type !== _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_CATEGORY.IN_APP) return false;\n      if (((_this$modalConfig$ada8 = this.modalConfig.adapters) === null || _this$modalConfig$ada8 === void 0 || (_this$modalConfig$ada8 = _this$modalConfig$ada8[adapter.name]) === null || _this$modalConfig$ada8 === void 0 ? void 0 : _this$modalConfig$ada8.showOnModal) !== true) return false;\n      if (!((_this$modalConfig$ada9 = this.modalConfig.adapters) !== null && _this$modalConfig$ada9 !== void 0 && (_this$modalConfig$ada9 = _this$modalConfig$ada9[adapter.name]) !== null && _this$modalConfig$ada9 !== void 0 && _this$modalConfig$ada9.loginMethods)) return true;\n      const mergedLoginMethods = (0,_web3auth_ui__WEBPACK_IMPORTED_MODULE_6__.getAdapterSocialLogins)(adapter.name, (_adapter$name = this.modalConfig.adapters[adapter.name]) === null || _adapter$name === void 0 ? void 0 : _adapter$name.loginMethods);\n      if (Object.values(mergedLoginMethods).some(method => method.showOnModal)) return true;\n      return false;\n    });\n    _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.log.debug(hasInAppWallets, this.walletAdapters, adapterNames, \"hasInAppWallets\");\n\n    // Now, initialize the adapters.\n    const initPromises = adapterNames.map(async adapterName => {\n      if (!adapterName) return;\n      try {\n        const adapter = this.walletAdapters[adapterName];\n        // only initialize a external adapter here if it is a cached adapter.\n        if (this.cachedAdapter !== adapterName && adapter.type === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_CATEGORY.EXTERNAL) {\n          return;\n        }\n        // in-app wallets or cached wallet (being connected or already connected) are initialized first.\n        // if adapter is configured then only initialize in app or cached adapter.\n        // external wallets are initialized on INIT_EXTERNAL_WALLET event.\n        this.subscribeToAdapterEvents(adapter);\n        if (adapter.status === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_STATUS.NOT_READY) await adapter.init({\n          autoConnect: this.cachedAdapter === adapterName\n        });\n        // note: not adding cachedWallet to modal if it is external wallet.\n        // adding it later if no in-app wallets are available.\n        if (adapter.type === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_CATEGORY.IN_APP) {\n          this.initializeInAppWallet(adapterName);\n        }\n      } catch (error) {\n        _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.log.error(error, \"error while initializing adapter \", adapterName);\n      }\n    });\n    this.commonJRPCProvider = await _web3auth_base_provider__WEBPACK_IMPORTED_MODULE_3__.CommonJRPCProvider.getProviderInstance({\n      chainConfig: this.coreOptions.chainConfig\n    });\n    await Promise.all(initPromises);\n    if (this.status === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_STATUS.NOT_READY) {\n      this.status = _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_STATUS.READY;\n      this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_EVENTS.READY);\n    }\n    const hasExternalWallets = allAdapters.some(adapterName => {\n      var _this$walletAdapters$, _this$modalConfig$ada10;\n      return ((_this$walletAdapters$ = this.walletAdapters[adapterName]) === null || _this$walletAdapters$ === void 0 ? void 0 : _this$walletAdapters$.type) === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_CATEGORY.EXTERNAL && ((_this$modalConfig$ada10 = this.modalConfig.adapters) === null || _this$modalConfig$ada10 === void 0 ? void 0 : _this$modalConfig$ada10[adapterName].showOnModal);\n    });\n    if (hasExternalWallets) {\n      this.loginModal.initExternalWalletContainer();\n    }\n\n    // variable to check if we have any in app wallets\n    // currently all default in app and external wallets can be hidden or shown based on config.\n    if (!hasInAppWallets && hasExternalWallets) {\n      // if no in app wallet is available then initialize external wallets in modal\n      await this.initExternalWalletAdapters(false, {\n        showExternalWalletsOnly: true\n      });\n    }\n  }\n  async connect() {\n    if (!this.loginModal) throw _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.WalletInitializationError.notReady(\"Login modal is not initialized\");\n    // if already connected return provider\n    if (this.connectedAdapterName && this.status === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_STATUS.CONNECTED && this.provider) return this.provider;\n    this.loginModal.open();\n    return new Promise((resolve, reject) => {\n      this.once(_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_EVENTS.CONNECTED, () => {\n        return resolve(this.provider);\n      });\n      this.once(_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_EVENTS.ERRORED, err => {\n        return reject(err);\n      });\n      this.once(_web3auth_ui__WEBPACK_IMPORTED_MODULE_6__.LOGIN_MODAL_EVENTS.MODAL_VISIBILITY, visibility => {\n        // modal is closed but user is not connected to any wallet.\n        if (!visibility && this.status !== _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_STATUS.CONNECTED) {\n          return reject(new Error(\"User closed the modal\"));\n        }\n      });\n    });\n  }\n  async initExternalWalletAdapters(externalWalletsInitialized, options) {\n    if (externalWalletsInitialized) return;\n    const adaptersConfig = {};\n    Object.keys(this.walletAdapters).forEach(async adapterName => {\n      const adapter = this.walletAdapters[adapterName];\n      if ((adapter === null || adapter === void 0 ? void 0 : adapter.type) === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_CATEGORY.EXTERNAL) {\n        _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.log.debug(\"init external wallet\", this.cachedAdapter, adapterName);\n        this.subscribeToAdapterEvents(adapter);\n        // we are not initializing cached adapter here as it is already being initialized in initModal before.\n        if (this.cachedAdapter === adapterName) {\n          return;\n        }\n        if (adapter.status === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_STATUS.NOT_READY) {\n          await adapter.init({\n            autoConnect: this.cachedAdapter === adapterName\n          }).then(() => {\n            adaptersConfig[adapterName] = this.modalConfig.adapters[adapterName];\n            this.loginModal.addWalletLogins(adaptersConfig, {\n              showExternalWalletsOnly: !!(options !== null && options !== void 0 && options.showExternalWalletsOnly)\n            });\n            return undefined;\n          }).catch(error => _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.log.error(error, \"error while initializing adapter\", adapterName));\n        } else if (adapter.status === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_STATUS.READY) {\n          adaptersConfig[adapterName] = this.modalConfig.adapters[adapterName];\n          this.loginModal.addWalletLogins(adaptersConfig, {\n            showExternalWalletsOnly: !!(options !== null && options !== void 0 && options.showExternalWalletsOnly)\n          });\n        }\n      }\n    });\n  }\n  initializeInAppWallet(adapterName) {\n    _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.log.info(\"adapterInitResults\", adapterName);\n    if (this.walletAdapters[adapterName].type === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_CATEGORY.IN_APP) {\n      var _adapterName, _this$options$uiConfi2, _this$options$uiConfi3, _this$options$uiConfi4;\n      this.loginModal.addSocialLogins(adapterName, (0,_web3auth_ui__WEBPACK_IMPORTED_MODULE_6__.getAdapterSocialLogins)(adapterName, (_adapterName = this.modalConfig.adapters[adapterName]) === null || _adapterName === void 0 ? void 0 : _adapterName.loginMethods), ((_this$options$uiConfi2 = this.options.uiConfig) === null || _this$options$uiConfi2 === void 0 ? void 0 : _this$options$uiConfi2.loginMethodsOrder) || _web3auth_ui__WEBPACK_IMPORTED_MODULE_6__.OPENLOGIN_PROVIDERS, _babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_1___default()({}, this.options.uiConfig), {}, {\n        loginGridCol: ((_this$options$uiConfi3 = this.options.uiConfig) === null || _this$options$uiConfi3 === void 0 ? void 0 : _this$options$uiConfi3.loginGridCol) || 3,\n        primaryButton: ((_this$options$uiConfi4 = this.options.uiConfig) === null || _this$options$uiConfi4 === void 0 ? void 0 : _this$options$uiConfi4.primaryButton) || \"socialLogin\"\n      }));\n    }\n  }\n  subscribeToLoginModalEvents() {\n    this.loginModal.on(_web3auth_ui__WEBPACK_IMPORTED_MODULE_6__.LOGIN_MODAL_EVENTS.LOGIN, async params => {\n      try {\n        await this.connectTo(params.adapter, params.loginParams);\n      } catch (error) {\n        _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.log.error(`Error while connecting to adapter: ${params.adapter}`, error);\n      }\n    });\n    this.loginModal.on(_web3auth_ui__WEBPACK_IMPORTED_MODULE_6__.LOGIN_MODAL_EVENTS.INIT_EXTERNAL_WALLETS, async params => {\n      await this.initExternalWalletAdapters(params.externalWalletsInitialized);\n    });\n    this.loginModal.on(_web3auth_ui__WEBPACK_IMPORTED_MODULE_6__.LOGIN_MODAL_EVENTS.DISCONNECT, async () => {\n      try {\n        await this.logout();\n      } catch (error) {\n        _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.log.error(`Error while disconnecting`, error);\n      }\n    });\n    this.loginModal.on(_web3auth_ui__WEBPACK_IMPORTED_MODULE_6__.LOGIN_MODAL_EVENTS.MODAL_VISIBILITY, async visibility => {\n      _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.log.debug(\"is login modal visible\", visibility);\n      this.emit(_web3auth_ui__WEBPACK_IMPORTED_MODULE_6__.LOGIN_MODAL_EVENTS.MODAL_VISIBILITY, visibility);\n      const adapter = this.walletAdapters[_web3auth_base__WEBPACK_IMPORTED_MODULE_0__.WALLET_ADAPTERS.WALLET_CONNECT_V2];\n      if (adapter) {\n        const walletConnectStatus = adapter === null || adapter === void 0 ? void 0 : adapter.status;\n        _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.log.debug(\"trying refreshing wc session\", visibility, walletConnectStatus);\n        if (visibility && (walletConnectStatus === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_STATUS.READY || walletConnectStatus === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_STATUS.CONNECTING)) {\n          _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.log.debug(\"refreshing wc session\");\n\n          // refreshing session for wallet connect whenever modal is opened.\n          try {\n            adapter.connect();\n          } catch (error) {\n            _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.log.error(`Error while disconnecting to wallet connect in core`, error);\n          }\n        }\n        if (!visibility && this.status === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_STATUS.CONNECTED && (walletConnectStatus === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_STATUS.READY || walletConnectStatus === _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_STATUS.CONNECTING)) {\n          _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.log.debug(\"this stops wc adapter from trying to reconnect once proposal expires\");\n          adapter.status = _web3auth_base__WEBPACK_IMPORTED_MODULE_0__.ADAPTER_STATUS.READY;\n        }\n      }\n    });\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0B3ZWIzYXV0aCttb2RhbEA4LjEyLjdfQGJhYmVsK3J1bnRpbWVANy4yOC40X3JlYWN0LWRvbUAxOC4zLjFfcmVhY3RAMTguMy4xX19yZWFjdEAxOC4zLjFfdHlwZXNjcmlwdEA1LjYuMy9ub2RlX21vZHVsZXMvQHdlYjNhdXRoL21vZGFsL2Rpc3QvbW9kYWwuZXNtLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBd047QUFDdko7QUFDRztBQUNQO0FBQ1I7QUFDc0Q7QUFDd0M7QUFDMUc7QUFDUjs7QUFFakM7QUFDQSxrQkFBa0IsNERBQWdCO0FBQ2xDO0FBQ0EsS0FBSywyREFBZTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxLQUFLLDJEQUFlO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEtBQUssMkRBQWU7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiw0REFBZ0I7QUFDbEM7QUFDQSxLQUFLLHdEQUFZO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEtBQUssd0RBQVk7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsS0FBSyx3REFBWTtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxLQUFLLHdEQUFZO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsNERBQWdCO0FBQ2xDO0FBQ0EsS0FBSywyREFBZTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLDREQUFnQjtBQUNsQztBQUNBLEtBQUssd0RBQVk7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiw0REFBZ0I7QUFDbEM7QUFDQSxLQUFLLHdEQUFZ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Q1osWUFBWSwrQ0FBRztBQUNmO0FBQ0E7QUFDQSwyQ0FBMkMsMERBQWMsdUNBQXVDLDBEQUFjLGtDQUFrQywwREFBYztBQUM5SixVQUFVLCtDQUFHO0FBQ2IsMkJBQTJCLDBEQUFjO0FBQ3pDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFbUsiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AY29sbGVjdGlibGUvd2ViLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9Ad2ViM2F1dGgrbW9kYWxAOC4xMi43X0BiYWJlbCtydW50aW1lQDcuMjguNF9yZWFjdC1kb21AMTguMy4xX3JlYWN0QDE4LjMuMV9fcmVhY3RAMTguMy4xX3R5cGVzY3JpcHRANS42LjMvbm9kZV9tb2R1bGVzL0B3ZWIzYXV0aC9tb2RhbC9kaXN0L21vZGFsLmVzbS5qcz85OTkxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENIQUlOX05BTUVTUEFDRVMsIFNPTEFOQV9BREFQVEVSUywgRVZNX0FEQVBURVJTLCBXYWxsZXRJbml0aWFsaXphdGlvbkVycm9yLCBmZXRjaFByb2plY3RDb25maWcsIGxvZywgV0FMTEVUX0FEQVBURVJTLCBnZXRDaGFpbkNvbmZpZywgQURBUFRFUl9DQVRFR09SWSwgQURBUFRFUl9TVEFUVVMsIEFEQVBURVJfRVZFTlRTIH0gZnJvbSAnQHdlYjNhdXRoL2Jhc2UnO1xuaW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAnQGJhYmVsL3J1bnRpbWUvaGVscGVycy9vYmplY3RTcHJlYWQyJztcbmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAnQGJhYmVsL3J1bnRpbWUvaGVscGVycy9kZWZpbmVQcm9wZXJ0eSc7XG5pbXBvcnQgeyBDb21tb25KUlBDUHJvdmlkZXIgfSBmcm9tICdAd2ViM2F1dGgvYmFzZS1wcm92aWRlcic7XG5pbXBvcnQgeyBXZWIzQXV0aE5vTW9kYWwgfSBmcm9tICdAd2ViM2F1dGgvbm8tbW9kYWwnO1xuaW1wb3J0IHsgTE9HSU5fUFJPVklERVIsIGdldE9wZW5sb2dpbkRlZmF1bHRPcHRpb25zLCBPcGVubG9naW5BZGFwdGVyIH0gZnJvbSAnQHdlYjNhdXRoL29wZW5sb2dpbi1hZGFwdGVyJztcbmltcG9ydCB7IGdldFVzZXJMYW5ndWFnZSwgTG9naW5Nb2RhbCwgY2FwaXRhbGl6ZUZpcnN0TGV0dGVyLCBnZXRBZGFwdGVyU29jaWFsTG9naW5zLCBMT0dJTl9NT0RBTF9FVkVOVFMsIE9QRU5MT0dJTl9QUk9WSURFUlMgfSBmcm9tICdAd2ViM2F1dGgvdWknO1xuaW1wb3J0IGNsb25lZGVlcCBmcm9tICdsb2Rhc2guY2xvbmVkZWVwJztcbmltcG9ydCBtZXJnZSBmcm9tICdsb2Rhc2gubWVyZ2UnO1xuXG5jb25zdCBkZWZhdWx0U29sYW5hRGFwcE1vZGFsQ29uZmlnID0ge1xuICBjaGFpbk5hbWVzcGFjZTogQ0hBSU5fTkFNRVNQQUNFUy5TT0xBTkEsXG4gIGFkYXB0ZXJzOiB7XG4gICAgW1NPTEFOQV9BREFQVEVSUy5UT1JVU19TT0xBTkFdOiB7XG4gICAgICBsYWJlbDogXCJUb3J1cyBXYWxsZXRcIixcbiAgICAgIHNob3dPbk1vZGFsOiB0cnVlLFxuICAgICAgc2hvd09uTW9iaWxlOiB0cnVlLFxuICAgICAgc2hvd09uRGVza3RvcDogdHJ1ZVxuICAgIH0sXG4gICAgW1NPTEFOQV9BREFQVEVSUy5PUEVOTE9HSU5dOiB7XG4gICAgICBsYWJlbDogXCJPcGVuTG9naW5cIixcbiAgICAgIHNob3dPbk1vZGFsOiB0cnVlLFxuICAgICAgc2hvd09uTW9iaWxlOiB0cnVlLFxuICAgICAgc2hvd09uRGVza3RvcDogdHJ1ZVxuICAgIH0sXG4gICAgW1NPTEFOQV9BREFQVEVSUy5QSEFOVE9NXToge1xuICAgICAgbGFiZWw6IFwiUGhhbnRvbVwiLFxuICAgICAgc2hvd09uTW9kYWw6IHRydWUsXG4gICAgICBzaG93T25Nb2JpbGU6IHRydWUsXG4gICAgICBzaG93T25EZXNrdG9wOiB0cnVlXG4gICAgfVxuICB9XG59O1xuY29uc3QgZGVmYXVsdEV2bURhcHBNb2RhbENvbmZpZyA9IHtcbiAgY2hhaW5OYW1lc3BhY2U6IENIQUlOX05BTUVTUEFDRVMuRUlQMTU1LFxuICBhZGFwdGVyczoge1xuICAgIFtFVk1fQURBUFRFUlMuVE9SVVNfRVZNXToge1xuICAgICAgbGFiZWw6IFwiVG9ydXMgV2FsbGV0XCIsXG4gICAgICBzaG93T25Nb2RhbDogdHJ1ZSxcbiAgICAgIHNob3dPbk1vYmlsZTogdHJ1ZSxcbiAgICAgIHNob3dPbkRlc2t0b3A6IHRydWVcbiAgICB9LFxuICAgIFtFVk1fQURBUFRFUlMuTUVUQU1BU0tdOiB7XG4gICAgICBsYWJlbDogXCJNZXRhTWFza1wiLFxuICAgICAgc2hvd09uTW9kYWw6IHRydWUsXG4gICAgICBzaG93T25Nb2JpbGU6IHRydWUsXG4gICAgICBzaG93T25EZXNrdG9wOiB0cnVlXG4gICAgfSxcbiAgICBbRVZNX0FEQVBURVJTLk9QRU5MT0dJTl06IHtcbiAgICAgIGxhYmVsOiBcIk9wZW5Mb2dpblwiLFxuICAgICAgc2hvd09uTW9kYWw6IHRydWUsXG4gICAgICBzaG93T25Nb2JpbGU6IHRydWUsXG4gICAgICBzaG93T25EZXNrdG9wOiB0cnVlXG4gICAgfSxcbiAgICBbRVZNX0FEQVBURVJTLldBTExFVF9DT05ORUNUX1YyXToge1xuICAgICAgbGFiZWw6IFwiV2FsbGV0IENvbm5lY3RcIixcbiAgICAgIHNob3dPbk1vZGFsOiB0cnVlLFxuICAgICAgc2hvd09uTW9iaWxlOiB0cnVlLFxuICAgICAgc2hvd09uRGVza3RvcDogdHJ1ZVxuICAgIH1cbiAgfVxufTtcbmNvbnN0IGRlZmF1bHRTb2xhbmFXYWxsZXRNb2RhbENvbmZpZyA9IHtcbiAgY2hhaW5OYW1lc3BhY2U6IENIQUlOX05BTUVTUEFDRVMuU09MQU5BLFxuICBhZGFwdGVyczoge1xuICAgIFtTT0xBTkFfQURBUFRFUlMuT1BFTkxPR0lOXToge1xuICAgICAgbGFiZWw6IFwiT3BlbkxvZ2luXCIsXG4gICAgICBzaG93T25Nb2RhbDogdHJ1ZSxcbiAgICAgIHNob3dPbk1vYmlsZTogdHJ1ZSxcbiAgICAgIHNob3dPbkRlc2t0b3A6IHRydWVcbiAgICB9XG4gIH1cbn07XG5jb25zdCBkZWZhdWx0RXZtV2FsbGV0TW9kYWxDb25maWcgPSB7XG4gIGNoYWluTmFtZXNwYWNlOiBDSEFJTl9OQU1FU1BBQ0VTLkVJUDE1NSxcbiAgYWRhcHRlcnM6IHtcbiAgICBbRVZNX0FEQVBURVJTLk9QRU5MT0dJTl06IHtcbiAgICAgIGxhYmVsOiBcIk9wZW5Mb2dpblwiLFxuICAgICAgc2hvd09uTW9kYWw6IHRydWUsXG4gICAgICBzaG93T25Nb2JpbGU6IHRydWUsXG4gICAgICBzaG93T25EZXNrdG9wOiB0cnVlXG4gICAgfVxuICB9XG59O1xuY29uc3QgZGVmYXVsdE90aGVyTW9kYWxDb25maWcgPSB7XG4gIGNoYWluTmFtZXNwYWNlOiBDSEFJTl9OQU1FU1BBQ0VTLk9USEVSLFxuICBhZGFwdGVyczoge1xuICAgIFtFVk1fQURBUFRFUlMuT1BFTkxPR0lOXToge1xuICAgICAgbGFiZWw6IFwiT3BlbkxvZ2luXCIsXG4gICAgICBzaG93T25Nb2RhbDogdHJ1ZSxcbiAgICAgIHNob3dPbk1vYmlsZTogdHJ1ZSxcbiAgICAgIHNob3dPbkRlc2t0b3A6IHRydWVcbiAgICB9XG4gIH1cbn07XG5cbmNsYXNzIFdlYjNBdXRoIGV4dGVuZHMgV2ViM0F1dGhOb01vZGFsIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIHN1cGVyKG9wdGlvbnMpO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImxvZ2luTW9kYWxcIiwgdm9pZCAwKTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJvcHRpb25zXCIsIHZvaWQgMCk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwibW9kYWxDb25maWdcIiwgZGVmYXVsdE90aGVyTW9kYWxDb25maWcpO1xuICAgIHRoaXMub3B0aW9ucyA9IF9vYmplY3RTcHJlYWQoe30sIG9wdGlvbnMpO1xuICAgIGlmICghdGhpcy5vcHRpb25zLnVpQ29uZmlnKSB0aGlzLm9wdGlvbnMudWlDb25maWcgPSB7fTtcbiAgICBpZiAoIXRoaXMuY29yZU9wdGlvbnMucHJpdmF0ZUtleVByb3ZpZGVyKSB0aHJvdyBXYWxsZXRJbml0aWFsaXphdGlvbkVycm9yLmludmFsaWRQYXJhbXMoXCJwcml2YXRlS2V5UHJvdmlkZXIgaXMgcmVxdWlyZWRcIik7XG4gIH1cbiAgc2V0TW9kYWxDb25maWcobW9kYWxDb25maWcpIHtcbiAgICBzdXBlci5jaGVja0luaXRSZXF1aXJlbWVudHMoKTtcbiAgICB0aGlzLm1vZGFsQ29uZmlnID0gbW9kYWxDb25maWc7XG4gIH1cbiAgYXN5bmMgaW5pdE1vZGFsKHBhcmFtcykge1xuICAgIHN1cGVyLmNoZWNrSW5pdFJlcXVpcmVtZW50cygpO1xuICAgIGxldCBwcm9qZWN0Q29uZmlnO1xuICAgIHRyeSB7XG4gICAgICBwcm9qZWN0Q29uZmlnID0gYXdhaXQgZmV0Y2hQcm9qZWN0Q29uZmlnKHRoaXMub3B0aW9ucy5jbGllbnRJZCwgdGhpcy5vcHRpb25zLndlYjNBdXRoTmV0d29yayk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbG9nLmVycm9yKFwiRmFpbGVkIHRvIGZldGNoIHByb2plY3QgY29uZmlndXJhdGlvbnNcIiwgZSk7XG4gICAgICB0aHJvdyBXYWxsZXRJbml0aWFsaXphdGlvbkVycm9yLm5vdFJlYWR5KFwiZmFpbGVkIHRvIGZldGNoIHByb2plY3QgY29uZmlndXJhdGlvbnNcIiwgZSk7XG4gICAgfVxuICAgIGNvbnN0IHtcbiAgICAgIHdoaXRlbGFiZWxcbiAgICB9ID0gcHJvamVjdENvbmZpZztcbiAgICB0aGlzLm9wdGlvbnMudWlDb25maWcgPSBtZXJnZShjbG9uZWRlZXAod2hpdGVsYWJlbCksIHRoaXMub3B0aW9ucy51aUNvbmZpZyk7XG4gICAgaWYgKCF0aGlzLm9wdGlvbnMudWlDb25maWcuZGVmYXVsdExhbmd1YWdlKSB0aGlzLm9wdGlvbnMudWlDb25maWcuZGVmYXVsdExhbmd1YWdlID0gZ2V0VXNlckxhbmd1YWdlKHRoaXMub3B0aW9ucy51aUNvbmZpZy5kZWZhdWx0TGFuZ3VhZ2UpO1xuICAgIGlmICghdGhpcy5vcHRpb25zLnVpQ29uZmlnLm1vZGUpIHRoaXMub3B0aW9ucy51aUNvbmZpZy5tb2RlID0gXCJsaWdodFwiO1xuICAgIHRoaXMubG9naW5Nb2RhbCA9IG5ldyBMb2dpbk1vZGFsKF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgdGhpcy5vcHRpb25zLnVpQ29uZmlnKSwge30sIHtcbiAgICAgIGFkYXB0ZXJMaXN0ZW5lcjogdGhpc1xuICAgIH0pKTtcbiAgICB0aGlzLnN1YnNjcmliZVRvTG9naW5Nb2RhbEV2ZW50cygpO1xuICAgIGNvbnN0IHtcbiAgICAgIHNtc19vdHBfZW5hYmxlZDogc21zT3RwRW5hYmxlZCxcbiAgICAgIHdoaXRlbGlzdFxuICAgIH0gPSBwcm9qZWN0Q29uZmlnO1xuICAgIGlmIChzbXNPdHBFbmFibGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHZhciBfcGFyYW1zO1xuICAgICAgY29uc3QgYWRhcHRlckNvbmZpZyA9IHtcbiAgICAgICAgW1dBTExFVF9BREFQVEVSUy5PUEVOTE9HSU5dOiB7XG4gICAgICAgICAgbGFiZWw6IFdBTExFVF9BREFQVEVSUy5PUEVOTE9HSU4sXG4gICAgICAgICAgbG9naW5NZXRob2RzOiB7XG4gICAgICAgICAgICBbTE9HSU5fUFJPVklERVIuU01TX1BBU1NXT1JETEVTU106IHtcbiAgICAgICAgICAgICAgbmFtZTogTE9HSU5fUFJPVklERVIuU01TX1BBU1NXT1JETEVTUyxcbiAgICAgICAgICAgICAgc2hvd09uTW9kYWw6IHNtc090cEVuYWJsZWQsXG4gICAgICAgICAgICAgIHNob3dPbkRlc2t0b3A6IHNtc090cEVuYWJsZWQsXG4gICAgICAgICAgICAgIHNob3dPbk1vYmlsZTogc21zT3RwRW5hYmxlZFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIGlmICghKChfcGFyYW1zID0gcGFyYW1zKSAhPT0gbnVsbCAmJiBfcGFyYW1zICE9PSB2b2lkIDAgJiYgX3BhcmFtcy5tb2RhbENvbmZpZykpIHBhcmFtcyA9IHtcbiAgICAgICAgbW9kYWxDb25maWc6IHt9XG4gICAgICB9O1xuICAgICAgcGFyYW1zLm1vZGFsQ29uZmlnID0gbWVyZ2UoY2xvbmVkZWVwKHBhcmFtcy5tb2RhbENvbmZpZyksIGFkYXB0ZXJDb25maWcpO1xuICAgIH1cbiAgICBhd2FpdCB0aGlzLmxvZ2luTW9kYWwuaW5pdE1vZGFsKCk7XG4gICAgY29uc3QgcHJvdmlkZWRDaGFpbkNvbmZpZyA9IHRoaXMub3B0aW9ucy5jaGFpbkNvbmZpZztcbiAgICAvLyBtZXJnZSBkZWZhdWx0IGFkYXB0ZXJzIHdpdGggdGhlIGN1c3RvbSBjb25maWd1cmVkIGFkYXB0ZXJzLlxuICAgIGNvbnN0IGFsbEFkYXB0ZXJzID0gWy4uLm5ldyBTZXQoWy4uLk9iamVjdC5rZXlzKHRoaXMubW9kYWxDb25maWcuYWRhcHRlcnMgfHwge30pLCAuLi5PYmplY3Qua2V5cyh0aGlzLndhbGxldEFkYXB0ZXJzKV0pXTtcbiAgICBjb25zdCBhZGFwdGVyQ29uZmlndXJhdGlvblByb21pc2VzID0gYWxsQWRhcHRlcnMubWFwKGFzeW5jIGFkYXB0ZXJOYW1lID0+IHtcbiAgICAgIHZhciBfdGhpcyRtb2RhbENvbmZpZyRhZGEsIF9wYXJhbXMyLCBfdGhpcyRtb2RhbENvbmZpZyRhZGEyLCBfdGhpcyRtb2RhbENvbmZpZyRhZGEzO1xuICAgICAgLy8gc3RhcnQgd2l0aCB0aGUgZGVmYXVsdCBjb25maWcgb2YgYWRhcHRlci5cbiAgICAgIGxldCBhZGFwdGVyQ29uZmlnID0gKChfdGhpcyRtb2RhbENvbmZpZyRhZGEgPSB0aGlzLm1vZGFsQ29uZmlnLmFkYXB0ZXJzKSA9PT0gbnVsbCB8fCBfdGhpcyRtb2RhbENvbmZpZyRhZGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJG1vZGFsQ29uZmlnJGFkYVthZGFwdGVyTmFtZV0pIHx8IHtcbiAgICAgICAgbGFiZWw6IGFkYXB0ZXJOYW1lLnNwbGl0KFwiLVwiKS5tYXAoY2FwaXRhbGl6ZUZpcnN0TGV0dGVyKS5qb2luKFwiIFwiKSxcbiAgICAgICAgc2hvd09uTW9kYWw6IHRydWUsXG4gICAgICAgIHNob3dPbk1vYmlsZTogdHJ1ZSxcbiAgICAgICAgc2hvd09uRGVza3RvcDogdHJ1ZVxuICAgICAgfTtcblxuICAgICAgLy8gb3ZlcnJpZGUgdGhlIGRlZmF1bHQgY29uZmlnIG9mIGFkYXB0ZXIgaWYgc29tZSBjb25maWcgaXMgYmVpbmcgcHJvdmlkZWQgYnkgdGhlIHVzZXIuXG4gICAgICBpZiAoKF9wYXJhbXMyID0gcGFyYW1zKSAhPT0gbnVsbCAmJiBfcGFyYW1zMiAhPT0gdm9pZCAwICYmIChfcGFyYW1zMiA9IF9wYXJhbXMyLm1vZGFsQ29uZmlnKSAhPT0gbnVsbCAmJiBfcGFyYW1zMiAhPT0gdm9pZCAwICYmIF9wYXJhbXMyW2FkYXB0ZXJOYW1lXSkge1xuICAgICAgICBhZGFwdGVyQ29uZmlnID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBhZGFwdGVyQ29uZmlnKSwgcGFyYW1zLm1vZGFsQ29uZmlnW2FkYXB0ZXJOYW1lXSk7XG4gICAgICB9XG4gICAgICB0aGlzLm1vZGFsQ29uZmlnLmFkYXB0ZXJzW2FkYXB0ZXJOYW1lXSA9IGFkYXB0ZXJDb25maWc7XG5cbiAgICAgIC8vIGNoZWNrIGlmIGFkYXB0ZXIgaXMgY29uZmlndXJlZC9hZGRlZCBieSB1c2VyIGFuZCBleGlzdCBpbiB3YWxsZXRBZGFwdGVycyBtYXAuXG4gICAgICBjb25zdCBhZGFwdGVyID0gdGhpcy53YWxsZXRBZGFwdGVyc1thZGFwdGVyTmFtZV07XG4gICAgICBsb2cuZGVidWcoXCJhZGFwdGVyIGNvbmZpZ1wiLCBhZGFwdGVyTmFtZSwgKF90aGlzJG1vZGFsQ29uZmlnJGFkYTIgPSB0aGlzLm1vZGFsQ29uZmlnLmFkYXB0ZXJzKSA9PT0gbnVsbCB8fCBfdGhpcyRtb2RhbENvbmZpZyRhZGEyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRtb2RhbENvbmZpZyRhZGEyW2FkYXB0ZXJOYW1lXS5zaG93T25Nb2RhbCwgYWRhcHRlcik7XG5cbiAgICAgIC8vIGlmIGFkYXB0ZXIgaXMgbm90IGN1c3RvbSBjb25maWd1cmVkIHRoZW4gY2hlY2sgaWYgaXQgaXMgYXZhaWxhYmxlIGluIGRlZmF1bHQgYWRhcHRlcnMuXG4gICAgICAvLyBhbmQgaWYgYWRhcHRlciBpcyBub3QgaGlkZGVuIGJ5IHVzZXJcbiAgICAgIGlmICghYWRhcHRlciAmJiAoX3RoaXMkbW9kYWxDb25maWckYWRhMyA9IHRoaXMubW9kYWxDb25maWcuYWRhcHRlcnMpICE9PSBudWxsICYmIF90aGlzJG1vZGFsQ29uZmlnJGFkYTMgIT09IHZvaWQgMCAmJiBfdGhpcyRtb2RhbENvbmZpZyRhZGEzW2FkYXB0ZXJOYW1lXS5zaG93T25Nb2RhbCkge1xuICAgICAgICAvLyBBZGFwdGVycyB0byBiZSBzaG93biBvbiBtb2RhbCBzaG91bGQgYmUgcHJlLWNvbmZpZ3VyZWQuXG4gICAgICAgIGlmIChhZGFwdGVyTmFtZSA9PT0gV0FMTEVUX0FEQVBURVJTLk9QRU5MT0dJTikge1xuICAgICAgICAgIHZhciBfdGhpcyRjb3JlT3B0aW9ucyRjaGE7XG4gICAgICAgICAgY29uc3QgZGVmYXVsdE9wdGlvbnMgPSBnZXRPcGVubG9naW5EZWZhdWx0T3B0aW9ucygpO1xuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGNsaWVudElkLFxuICAgICAgICAgICAgdXNlQ29yZUtpdEtleSxcbiAgICAgICAgICAgIGNoYWluQ29uZmlnLFxuICAgICAgICAgICAgd2ViM0F1dGhOZXR3b3JrLFxuICAgICAgICAgICAgc2Vzc2lvblRpbWUsXG4gICAgICAgICAgICBwcml2YXRlS2V5UHJvdmlkZXJcbiAgICAgICAgICB9ID0gdGhpcy5jb3JlT3B0aW9ucztcbiAgICAgICAgICBjb25zdCBmaW5hbENoYWluQ29uZmlnID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBnZXRDaGFpbkNvbmZpZyhwcm92aWRlZENoYWluQ29uZmlnLmNoYWluTmFtZXNwYWNlLCAoX3RoaXMkY29yZU9wdGlvbnMkY2hhID0gdGhpcy5jb3JlT3B0aW9ucy5jaGFpbkNvbmZpZykgPT09IG51bGwgfHwgX3RoaXMkY29yZU9wdGlvbnMkY2hhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRjb3JlT3B0aW9ucyRjaGEuY2hhaW5JZCkpLCBjaGFpbkNvbmZpZyk7XG4gICAgICAgICAgaWYgKCFwcml2YXRlS2V5UHJvdmlkZXIpIHtcbiAgICAgICAgICAgIHRocm93IFdhbGxldEluaXRpYWxpemF0aW9uRXJyb3IuaW52YWxpZFBhcmFtcyhcInByaXZhdGVLZXlQcm92aWRlciBpcyByZXF1aXJlZFwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgZmluYWxPcGVubG9naW5BZGFwdGVyU2V0dGluZ3MgPSBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGRlZmF1bHRPcHRpb25zLmFkYXB0ZXJTZXR0aW5ncyksIHt9LCB7XG4gICAgICAgICAgICBjbGllbnRJZCxcbiAgICAgICAgICAgIG5ldHdvcms6IHdlYjNBdXRoTmV0d29yayxcbiAgICAgICAgICAgIHdoaXRlTGFiZWw6IHRoaXMub3B0aW9ucy51aUNvbmZpZ1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmIChzbXNPdHBFbmFibGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGZpbmFsT3BlbmxvZ2luQWRhcHRlclNldHRpbmdzLmxvZ2luQ29uZmlnID0ge1xuICAgICAgICAgICAgICBbTE9HSU5fUFJPVklERVIuU01TX1BBU1NXT1JETEVTU106IHtcbiAgICAgICAgICAgICAgICBzaG93T25Nb2RhbDogc21zT3RwRW5hYmxlZCxcbiAgICAgICAgICAgICAgICBzaG93T25EZXNrdG9wOiBzbXNPdHBFbmFibGVkLFxuICAgICAgICAgICAgICAgIHNob3dPbk1vYmlsZTogc21zT3RwRW5hYmxlZCxcbiAgICAgICAgICAgICAgICBzaG93T25Tb2NpYWxCYWNrdXBGYWN0b3I6IHNtc090cEVuYWJsZWRcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHdoaXRlbGlzdCkge1xuICAgICAgICAgICAgZmluYWxPcGVubG9naW5BZGFwdGVyU2V0dGluZ3Mub3JpZ2luRGF0YSA9IHdoaXRlbGlzdC5zaWduZWRfdXJscztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy51aUNvbmZpZy51eE1vZGUpIHtcbiAgICAgICAgICAgIGZpbmFsT3BlbmxvZ2luQWRhcHRlclNldHRpbmdzLnV4TW9kZSA9IHRoaXMub3B0aW9ucy51aUNvbmZpZy51eE1vZGU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IG9wZW5sb2dpbkFkYXB0ZXIgPSBuZXcgT3BlbmxvZ2luQWRhcHRlcihfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGRlZmF1bHRPcHRpb25zKSwge30sIHtcbiAgICAgICAgICAgIGNsaWVudElkLFxuICAgICAgICAgICAgdXNlQ29yZUtpdEtleSxcbiAgICAgICAgICAgIGNoYWluQ29uZmlnOiBfb2JqZWN0U3ByZWFkKHt9LCBmaW5hbENoYWluQ29uZmlnKSxcbiAgICAgICAgICAgIGFkYXB0ZXJTZXR0aW5nczogZmluYWxPcGVubG9naW5BZGFwdGVyU2V0dGluZ3MsXG4gICAgICAgICAgICBzZXNzaW9uVGltZSxcbiAgICAgICAgICAgIHdlYjNBdXRoTmV0d29yayxcbiAgICAgICAgICAgIHByaXZhdGVLZXlQcm92aWRlclxuICAgICAgICAgIH0pKTtcbiAgICAgICAgICB0aGlzLndhbGxldEFkYXB0ZXJzW2FkYXB0ZXJOYW1lXSA9IG9wZW5sb2dpbkFkYXB0ZXI7XG4gICAgICAgICAgcmV0dXJuIGFkYXB0ZXJOYW1lO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IFdhbGxldEluaXRpYWxpemF0aW9uRXJyb3IuaW52YWxpZFBhcmFtcyhgQWRhcHRlciAke2FkYXB0ZXJOYW1lfSBpcyBub3QgY29uZmlndXJlZGApO1xuICAgICAgfSBlbHNlIGlmICgoYWRhcHRlciA9PT0gbnVsbCB8fCBhZGFwdGVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBhZGFwdGVyLnR5cGUpID09PSBBREFQVEVSX0NBVEVHT1JZLklOX0FQUCB8fCAoYWRhcHRlciA9PT0gbnVsbCB8fCBhZGFwdGVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBhZGFwdGVyLnR5cGUpID09PSBBREFQVEVSX0NBVEVHT1JZLkVYVEVSTkFMIHx8IGFkYXB0ZXJOYW1lID09PSB0aGlzLmNhY2hlZEFkYXB0ZXIpIHtcbiAgICAgICAgdmFyIF90aGlzJG1vZGFsQ29uZmlnJGFkYTQ7XG4gICAgICAgIGlmICghKChfdGhpcyRtb2RhbENvbmZpZyRhZGE0ID0gdGhpcy5tb2RhbENvbmZpZy5hZGFwdGVycykgIT09IG51bGwgJiYgX3RoaXMkbW9kYWxDb25maWckYWRhNCAhPT0gdm9pZCAwICYmIF90aGlzJG1vZGFsQ29uZmlnJGFkYTRbYWRhcHRlck5hbWVdLnNob3dPbk1vZGFsKSkgcmV0dXJuO1xuICAgICAgICAvLyBhZGQgY2xpZW50IGlkIHRvIGFkYXB0ZXIsIHNhbWUgd2ViM2F1dGggY2xpZW50IGlkIGNhbiBiZSB1c2VkIGluIGFkYXB0ZXIuXG4gICAgICAgIC8vIHRoaXMgaWQgaXMgYmVpbmcgb3ZlcnJpZGRlbiBpZiB1c2VyIGlzIGFsc28gcGFzc2luZyBjbGllbnQgaWQgaW4gYWRhcHRlcidzIGNvbnN0cnVjdG9yLlxuICAgICAgICB0aGlzLndhbGxldEFkYXB0ZXJzW2FkYXB0ZXJOYW1lXS5zZXRBZGFwdGVyU2V0dGluZ3Moe1xuICAgICAgICAgIGNsaWVudElkOiB0aGlzLm9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgc2Vzc2lvblRpbWU6IHRoaXMub3B0aW9ucy5zZXNzaW9uVGltZSxcbiAgICAgICAgICB3ZWIzQXV0aE5ldHdvcms6IHRoaXMub3B0aW9ucy53ZWIzQXV0aE5ldHdvcmssXG4gICAgICAgICAgdXNlQ29yZUtpdEtleTogdGhpcy5jb3JlT3B0aW9ucy51c2VDb3JlS2l0S2V5XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGlmIGFkYXB0ZXIgZG9lc24ndCBoYXZlIGFueSBjaGFpbkNvbmZpZyB0aGVuIHdlIHdpbGwgc2V0IHRoZSBjaGFpbkNvbmZpZyBiYXNlZCBvZiBwYXNzZWQgY2hhaW5OYW1lc3BhY2VcbiAgICAgICAgLy8gYW5kIGNoYWluTmFtZXNwYWNlLlxuICAgICAgICBpZiAoIWFkYXB0ZXIuY2hhaW5Db25maWdQcm94eSkge1xuICAgICAgICAgIHZhciBfdGhpcyRjb3JlT3B0aW9ucyRjaGEyO1xuICAgICAgICAgIGNvbnN0IGNoYWluQ29uZmlnID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBnZXRDaGFpbkNvbmZpZyhwcm92aWRlZENoYWluQ29uZmlnLmNoYWluTmFtZXNwYWNlLCAoX3RoaXMkY29yZU9wdGlvbnMkY2hhMiA9IHRoaXMuY29yZU9wdGlvbnMuY2hhaW5Db25maWcpID09PSBudWxsIHx8IF90aGlzJGNvcmVPcHRpb25zJGNoYTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJGNvcmVPcHRpb25zJGNoYTIuY2hhaW5JZCkpLCB0aGlzLmNvcmVPcHRpb25zLmNoYWluQ29uZmlnKTtcbiAgICAgICAgICB0aGlzLndhbGxldEFkYXB0ZXJzW2FkYXB0ZXJOYW1lXS5zZXRBZGFwdGVyU2V0dGluZ3Moe1xuICAgICAgICAgICAgY2hhaW5Db25maWdcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYWRhcHRlck5hbWUgPT09IFdBTExFVF9BREFQVEVSUy5PUEVOTE9HSU4pIHtcbiAgICAgICAgICB2YXIgX3RoaXMkb3B0aW9ucyR1aUNvbmZpO1xuICAgICAgICAgIGNvbnN0IG9wZW5sb2dpbkFkYXB0ZXIgPSB0aGlzLndhbGxldEFkYXB0ZXJzW2FkYXB0ZXJOYW1lXTtcbiAgICAgICAgICBpZiAodGhpcy5jb3JlT3B0aW9ucy5wcml2YXRlS2V5UHJvdmlkZXIpIHtcbiAgICAgICAgICAgIGlmIChvcGVubG9naW5BZGFwdGVyLmN1cnJlbnRDaGFpbk5hbWVzcGFjZSAhPT0gdGhpcy5jb3JlT3B0aW9ucy5wcml2YXRlS2V5UHJvdmlkZXIuY3VycmVudENoYWluQ29uZmlnLmNoYWluTmFtZXNwYWNlKSB7XG4gICAgICAgICAgICAgIHRocm93IFdhbGxldEluaXRpYWxpemF0aW9uRXJyb3IuaW5jb21wYXRpYmxlQ2hhaW5OYW1lU3BhY2UoXCJwcml2YXRlIGtleSBwcm92aWRlciBpcyBub3QgY29tcGF0aWJsZSB3aXRoIHByb3ZpZGVkIGNoYWluTmFtZXNwYWNlIGZvciBvcGVubG9naW4gYWRhcHRlclwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9wZW5sb2dpbkFkYXB0ZXIuc2V0QWRhcHRlclNldHRpbmdzKHtcbiAgICAgICAgICAgICAgcHJpdmF0ZUtleVByb3ZpZGVyOiB0aGlzLmNvcmVPcHRpb25zLnByaXZhdGVLZXlQcm92aWRlclxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChzbXNPdHBFbmFibGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG9wZW5sb2dpbkFkYXB0ZXIuc2V0QWRhcHRlclNldHRpbmdzKHtcbiAgICAgICAgICAgICAgbG9naW5Db25maWc6IHtcbiAgICAgICAgICAgICAgICBbTE9HSU5fUFJPVklERVIuU01TX1BBU1NXT1JETEVTU106IHtcbiAgICAgICAgICAgICAgICAgIHNob3dPbk1vZGFsOiBzbXNPdHBFbmFibGVkLFxuICAgICAgICAgICAgICAgICAgc2hvd09uRGVza3RvcDogc21zT3RwRW5hYmxlZCxcbiAgICAgICAgICAgICAgICAgIHNob3dPbk1vYmlsZTogc21zT3RwRW5hYmxlZCxcbiAgICAgICAgICAgICAgICAgIHNob3dPblNvY2lhbEJhY2t1cEZhY3Rvcjogc21zT3RwRW5hYmxlZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh3aGl0ZWxpc3QpIHtcbiAgICAgICAgICAgIG9wZW5sb2dpbkFkYXB0ZXIuc2V0QWRhcHRlclNldHRpbmdzKHtcbiAgICAgICAgICAgICAgb3JpZ2luRGF0YTogd2hpdGVsaXN0LnNpZ25lZF91cmxzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKChfdGhpcyRvcHRpb25zJHVpQ29uZmkgPSB0aGlzLm9wdGlvbnMudWlDb25maWcpICE9PSBudWxsICYmIF90aGlzJG9wdGlvbnMkdWlDb25maSAhPT0gdm9pZCAwICYmIF90aGlzJG9wdGlvbnMkdWlDb25maS51eE1vZGUpIHtcbiAgICAgICAgICAgIG9wZW5sb2dpbkFkYXB0ZXIuc2V0QWRhcHRlclNldHRpbmdzKHtcbiAgICAgICAgICAgICAgdXhNb2RlOiB0aGlzLm9wdGlvbnMudWlDb25maWcudXhNb2RlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgb3BlbmxvZ2luQWRhcHRlci5zZXRBZGFwdGVyU2V0dGluZ3Moe1xuICAgICAgICAgICAgd2hpdGVMYWJlbDogdGhpcy5vcHRpb25zLnVpQ29uZmlnXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKCFvcGVubG9naW5BZGFwdGVyLnByaXZhdGVLZXlQcm92aWRlcikge1xuICAgICAgICAgICAgdGhyb3cgV2FsbGV0SW5pdGlhbGl6YXRpb25FcnJvci5pbnZhbGlkUGFyYW1zKFwicHJpdmF0ZUtleVByb3ZpZGVyIGlzIHJlcXVpcmVkIGZvciBvcGVubG9naW4gYWRhcHRlclwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoYWRhcHRlck5hbWUgPT09IFdBTExFVF9BREFQVEVSUy5XQUxMRVRfQ09OTkVDVF9WMikge1xuICAgICAgICAgIGNvbnN0IHdhbGxldENvbm5lY3RBZGFwdGVyID0gdGhpcy53YWxsZXRBZGFwdGVyc1thZGFwdGVyTmFtZV07XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgd2FsbGV0X2Nvbm5lY3RfZW5hYmxlZDogd2FsbGV0Q29ubmVjdEVuYWJsZWQsXG4gICAgICAgICAgICB3YWxsZXRfY29ubmVjdF9wcm9qZWN0X2lkOiB3YWxsZXRDb25uZWN0UHJvamVjdElkXG4gICAgICAgICAgfSA9IHByb2plY3RDb25maWc7XG4gICAgICAgICAgaWYgKHdhbGxldENvbm5lY3RFbmFibGVkID09PSBmYWxzZSkge1xuICAgICAgICAgICAgdmFyIF90aGlzJG1vZGFsQ29uZmlnJGFkYTUsIF90aGlzJG1vZGFsQ29uZmlnJGFkYTYsIF90aGlzJG1vZGFsQ29uZmlnJGFkYTc7XG4gICAgICAgICAgICAvLyBvdmVycmlkZSB1c2VyIHNwZWNpZmllZCBjb25maWcgYnkgaGlkaW5nIHdhbGxldCBjb25uZWN0XG4gICAgICAgICAgICB0aGlzLm1vZGFsQ29uZmlnLmFkYXB0ZXJzID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCAoX3RoaXMkbW9kYWxDb25maWckYWRhNSA9IHRoaXMubW9kYWxDb25maWcuYWRhcHRlcnMpICE9PSBudWxsICYmIF90aGlzJG1vZGFsQ29uZmlnJGFkYTUgIT09IHZvaWQgMCA/IF90aGlzJG1vZGFsQ29uZmlnJGFkYTUgOiB7fSksIHt9LCB7XG4gICAgICAgICAgICAgIFtXQUxMRVRfQURBUFRFUlMuV0FMTEVUX0NPTk5FQ1RfVjJdOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIChfdGhpcyRtb2RhbENvbmZpZyRhZGE2ID0gKF90aGlzJG1vZGFsQ29uZmlnJGFkYTcgPSB0aGlzLm1vZGFsQ29uZmlnLmFkYXB0ZXJzKSA9PT0gbnVsbCB8fCBfdGhpcyRtb2RhbENvbmZpZyRhZGE3ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRtb2RhbENvbmZpZyRhZGE3W1dBTExFVF9BREFQVEVSUy5XQUxMRVRfQ09OTkVDVF9WMl0pICE9PSBudWxsICYmIF90aGlzJG1vZGFsQ29uZmlnJGFkYTYgIT09IHZvaWQgMCA/IF90aGlzJG1vZGFsQ29uZmlnJGFkYTYgOiB7fSksIHt9LCB7XG4gICAgICAgICAgICAgICAgc2hvd09uTW9kYWw6IGZhbHNlXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMubW9kYWxDb25maWcuYWRhcHRlcnNbV0FMTEVUX0FEQVBURVJTLldBTExFVF9DT05ORUNUX1YyXS5zaG93T25Nb2RhbCA9IGZhbHNlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgX3dhbGxldENvbm5lY3RBZGFwdGVyO1xuICAgICAgICAgICAgaWYgKCEod2FsbGV0Q29ubmVjdEFkYXB0ZXIgIT09IG51bGwgJiYgd2FsbGV0Q29ubmVjdEFkYXB0ZXIgIT09IHZvaWQgMCAmJiAoX3dhbGxldENvbm5lY3RBZGFwdGVyID0gd2FsbGV0Q29ubmVjdEFkYXB0ZXIuYWRhcHRlck9wdGlvbnMpICE9PSBudWxsICYmIF93YWxsZXRDb25uZWN0QWRhcHRlciAhPT0gdm9pZCAwICYmIChfd2FsbGV0Q29ubmVjdEFkYXB0ZXIgPSBfd2FsbGV0Q29ubmVjdEFkYXB0ZXIuYWRhcHRlclNldHRpbmdzKSAhPT0gbnVsbCAmJiBfd2FsbGV0Q29ubmVjdEFkYXB0ZXIgIT09IHZvaWQgMCAmJiAoX3dhbGxldENvbm5lY3RBZGFwdGVyID0gX3dhbGxldENvbm5lY3RBZGFwdGVyLndhbGxldENvbm5lY3RJbml0T3B0aW9ucykgIT09IG51bGwgJiYgX3dhbGxldENvbm5lY3RBZGFwdGVyICE9PSB2b2lkIDAgJiYgX3dhbGxldENvbm5lY3RBZGFwdGVyLnByb2plY3RJZCkgJiYgIXdhbGxldENvbm5lY3RQcm9qZWN0SWQpIHRocm93IFdhbGxldEluaXRpYWxpemF0aW9uRXJyb3IuaW52YWxpZFBhcmFtcyhcIkludmFsaWQgd2FsbGV0IGNvbm5lY3QgcHJvamVjdCBpZC4gUGxlYXNlIGNvbmZpZ3VyZSBpdCBvbiB0aGUgZGFzaGJvYXJkXCIpO1xuICAgICAgICAgICAgaWYgKHdhbGxldENvbm5lY3RQcm9qZWN0SWQpIHtcbiAgICAgICAgICAgICAgd2FsbGV0Q29ubmVjdEFkYXB0ZXIuc2V0QWRhcHRlclNldHRpbmdzKHtcbiAgICAgICAgICAgICAgICBhZGFwdGVyU2V0dGluZ3M6IHtcbiAgICAgICAgICAgICAgICAgIHdhbGxldENvbm5lY3RJbml0T3B0aW9uczoge1xuICAgICAgICAgICAgICAgICAgICBwcm9qZWN0SWQ6IHdhbGxldENvbm5lY3RQcm9qZWN0SWRcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWRhcHRlck5hbWU7XG4gICAgICB9XG4gICAgfSk7XG4gICAgY29uc3QgYWRhcHRlck5hbWVzID0gYXdhaXQgUHJvbWlzZS5hbGwoYWRhcHRlckNvbmZpZ3VyYXRpb25Qcm9taXNlcyk7XG4gICAgY29uc3QgaGFzSW5BcHBXYWxsZXRzID0gT2JqZWN0LnZhbHVlcyh0aGlzLndhbGxldEFkYXB0ZXJzKS5zb21lKGFkYXB0ZXIgPT4ge1xuICAgICAgdmFyIF90aGlzJG1vZGFsQ29uZmlnJGFkYTgsIF90aGlzJG1vZGFsQ29uZmlnJGFkYTksIF9hZGFwdGVyJG5hbWU7XG4gICAgICBpZiAoYWRhcHRlci50eXBlICE9PSBBREFQVEVSX0NBVEVHT1JZLklOX0FQUCkgcmV0dXJuIGZhbHNlO1xuICAgICAgaWYgKCgoX3RoaXMkbW9kYWxDb25maWckYWRhOCA9IHRoaXMubW9kYWxDb25maWcuYWRhcHRlcnMpID09PSBudWxsIHx8IF90aGlzJG1vZGFsQ29uZmlnJGFkYTggPT09IHZvaWQgMCB8fCAoX3RoaXMkbW9kYWxDb25maWckYWRhOCA9IF90aGlzJG1vZGFsQ29uZmlnJGFkYThbYWRhcHRlci5uYW1lXSkgPT09IG51bGwgfHwgX3RoaXMkbW9kYWxDb25maWckYWRhOCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkbW9kYWxDb25maWckYWRhOC5zaG93T25Nb2RhbCkgIT09IHRydWUpIHJldHVybiBmYWxzZTtcbiAgICAgIGlmICghKChfdGhpcyRtb2RhbENvbmZpZyRhZGE5ID0gdGhpcy5tb2RhbENvbmZpZy5hZGFwdGVycykgIT09IG51bGwgJiYgX3RoaXMkbW9kYWxDb25maWckYWRhOSAhPT0gdm9pZCAwICYmIChfdGhpcyRtb2RhbENvbmZpZyRhZGE5ID0gX3RoaXMkbW9kYWxDb25maWckYWRhOVthZGFwdGVyLm5hbWVdKSAhPT0gbnVsbCAmJiBfdGhpcyRtb2RhbENvbmZpZyRhZGE5ICE9PSB2b2lkIDAgJiYgX3RoaXMkbW9kYWxDb25maWckYWRhOS5sb2dpbk1ldGhvZHMpKSByZXR1cm4gdHJ1ZTtcbiAgICAgIGNvbnN0IG1lcmdlZExvZ2luTWV0aG9kcyA9IGdldEFkYXB0ZXJTb2NpYWxMb2dpbnMoYWRhcHRlci5uYW1lLCAoX2FkYXB0ZXIkbmFtZSA9IHRoaXMubW9kYWxDb25maWcuYWRhcHRlcnNbYWRhcHRlci5uYW1lXSkgPT09IG51bGwgfHwgX2FkYXB0ZXIkbmFtZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2FkYXB0ZXIkbmFtZS5sb2dpbk1ldGhvZHMpO1xuICAgICAgaWYgKE9iamVjdC52YWx1ZXMobWVyZ2VkTG9naW5NZXRob2RzKS5zb21lKG1ldGhvZCA9PiBtZXRob2Quc2hvd09uTW9kYWwpKSByZXR1cm4gdHJ1ZTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcbiAgICBsb2cuZGVidWcoaGFzSW5BcHBXYWxsZXRzLCB0aGlzLndhbGxldEFkYXB0ZXJzLCBhZGFwdGVyTmFtZXMsIFwiaGFzSW5BcHBXYWxsZXRzXCIpO1xuXG4gICAgLy8gTm93LCBpbml0aWFsaXplIHRoZSBhZGFwdGVycy5cbiAgICBjb25zdCBpbml0UHJvbWlzZXMgPSBhZGFwdGVyTmFtZXMubWFwKGFzeW5jIGFkYXB0ZXJOYW1lID0+IHtcbiAgICAgIGlmICghYWRhcHRlck5hbWUpIHJldHVybjtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGFkYXB0ZXIgPSB0aGlzLndhbGxldEFkYXB0ZXJzW2FkYXB0ZXJOYW1lXTtcbiAgICAgICAgLy8gb25seSBpbml0aWFsaXplIGEgZXh0ZXJuYWwgYWRhcHRlciBoZXJlIGlmIGl0IGlzIGEgY2FjaGVkIGFkYXB0ZXIuXG4gICAgICAgIGlmICh0aGlzLmNhY2hlZEFkYXB0ZXIgIT09IGFkYXB0ZXJOYW1lICYmIGFkYXB0ZXIudHlwZSA9PT0gQURBUFRFUl9DQVRFR09SWS5FWFRFUk5BTCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBpbi1hcHAgd2FsbGV0cyBvciBjYWNoZWQgd2FsbGV0IChiZWluZyBjb25uZWN0ZWQgb3IgYWxyZWFkeSBjb25uZWN0ZWQpIGFyZSBpbml0aWFsaXplZCBmaXJzdC5cbiAgICAgICAgLy8gaWYgYWRhcHRlciBpcyBjb25maWd1cmVkIHRoZW4gb25seSBpbml0aWFsaXplIGluIGFwcCBvciBjYWNoZWQgYWRhcHRlci5cbiAgICAgICAgLy8gZXh0ZXJuYWwgd2FsbGV0cyBhcmUgaW5pdGlhbGl6ZWQgb24gSU5JVF9FWFRFUk5BTF9XQUxMRVQgZXZlbnQuXG4gICAgICAgIHRoaXMuc3Vic2NyaWJlVG9BZGFwdGVyRXZlbnRzKGFkYXB0ZXIpO1xuICAgICAgICBpZiAoYWRhcHRlci5zdGF0dXMgPT09IEFEQVBURVJfU1RBVFVTLk5PVF9SRUFEWSkgYXdhaXQgYWRhcHRlci5pbml0KHtcbiAgICAgICAgICBhdXRvQ29ubmVjdDogdGhpcy5jYWNoZWRBZGFwdGVyID09PSBhZGFwdGVyTmFtZVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gbm90ZTogbm90IGFkZGluZyBjYWNoZWRXYWxsZXQgdG8gbW9kYWwgaWYgaXQgaXMgZXh0ZXJuYWwgd2FsbGV0LlxuICAgICAgICAvLyBhZGRpbmcgaXQgbGF0ZXIgaWYgbm8gaW4tYXBwIHdhbGxldHMgYXJlIGF2YWlsYWJsZS5cbiAgICAgICAgaWYgKGFkYXB0ZXIudHlwZSA9PT0gQURBUFRFUl9DQVRFR09SWS5JTl9BUFApIHtcbiAgICAgICAgICB0aGlzLmluaXRpYWxpemVJbkFwcFdhbGxldChhZGFwdGVyTmFtZSk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZy5lcnJvcihlcnJvciwgXCJlcnJvciB3aGlsZSBpbml0aWFsaXppbmcgYWRhcHRlciBcIiwgYWRhcHRlck5hbWUpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuY29tbW9uSlJQQ1Byb3ZpZGVyID0gYXdhaXQgQ29tbW9uSlJQQ1Byb3ZpZGVyLmdldFByb3ZpZGVySW5zdGFuY2Uoe1xuICAgICAgY2hhaW5Db25maWc6IHRoaXMuY29yZU9wdGlvbnMuY2hhaW5Db25maWdcbiAgICB9KTtcbiAgICBhd2FpdCBQcm9taXNlLmFsbChpbml0UHJvbWlzZXMpO1xuICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gQURBUFRFUl9TVEFUVVMuTk9UX1JFQURZKSB7XG4gICAgICB0aGlzLnN0YXR1cyA9IEFEQVBURVJfU1RBVFVTLlJFQURZO1xuICAgICAgdGhpcy5lbWl0KEFEQVBURVJfRVZFTlRTLlJFQURZKTtcbiAgICB9XG4gICAgY29uc3QgaGFzRXh0ZXJuYWxXYWxsZXRzID0gYWxsQWRhcHRlcnMuc29tZShhZGFwdGVyTmFtZSA9PiB7XG4gICAgICB2YXIgX3RoaXMkd2FsbGV0QWRhcHRlcnMkLCBfdGhpcyRtb2RhbENvbmZpZyRhZGExMDtcbiAgICAgIHJldHVybiAoKF90aGlzJHdhbGxldEFkYXB0ZXJzJCA9IHRoaXMud2FsbGV0QWRhcHRlcnNbYWRhcHRlck5hbWVdKSA9PT0gbnVsbCB8fCBfdGhpcyR3YWxsZXRBZGFwdGVycyQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHdhbGxldEFkYXB0ZXJzJC50eXBlKSA9PT0gQURBUFRFUl9DQVRFR09SWS5FWFRFUk5BTCAmJiAoKF90aGlzJG1vZGFsQ29uZmlnJGFkYTEwID0gdGhpcy5tb2RhbENvbmZpZy5hZGFwdGVycykgPT09IG51bGwgfHwgX3RoaXMkbW9kYWxDb25maWckYWRhMTAgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJG1vZGFsQ29uZmlnJGFkYTEwW2FkYXB0ZXJOYW1lXS5zaG93T25Nb2RhbCk7XG4gICAgfSk7XG4gICAgaWYgKGhhc0V4dGVybmFsV2FsbGV0cykge1xuICAgICAgdGhpcy5sb2dpbk1vZGFsLmluaXRFeHRlcm5hbFdhbGxldENvbnRhaW5lcigpO1xuICAgIH1cblxuICAgIC8vIHZhcmlhYmxlIHRvIGNoZWNrIGlmIHdlIGhhdmUgYW55IGluIGFwcCB3YWxsZXRzXG4gICAgLy8gY3VycmVudGx5IGFsbCBkZWZhdWx0IGluIGFwcCBhbmQgZXh0ZXJuYWwgd2FsbGV0cyBjYW4gYmUgaGlkZGVuIG9yIHNob3duIGJhc2VkIG9uIGNvbmZpZy5cbiAgICBpZiAoIWhhc0luQXBwV2FsbGV0cyAmJiBoYXNFeHRlcm5hbFdhbGxldHMpIHtcbiAgICAgIC8vIGlmIG5vIGluIGFwcCB3YWxsZXQgaXMgYXZhaWxhYmxlIHRoZW4gaW5pdGlhbGl6ZSBleHRlcm5hbCB3YWxsZXRzIGluIG1vZGFsXG4gICAgICBhd2FpdCB0aGlzLmluaXRFeHRlcm5hbFdhbGxldEFkYXB0ZXJzKGZhbHNlLCB7XG4gICAgICAgIHNob3dFeHRlcm5hbFdhbGxldHNPbmx5OiB0cnVlXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgY29ubmVjdCgpIHtcbiAgICBpZiAoIXRoaXMubG9naW5Nb2RhbCkgdGhyb3cgV2FsbGV0SW5pdGlhbGl6YXRpb25FcnJvci5ub3RSZWFkeShcIkxvZ2luIG1vZGFsIGlzIG5vdCBpbml0aWFsaXplZFwiKTtcbiAgICAvLyBpZiBhbHJlYWR5IGNvbm5lY3RlZCByZXR1cm4gcHJvdmlkZXJcbiAgICBpZiAodGhpcy5jb25uZWN0ZWRBZGFwdGVyTmFtZSAmJiB0aGlzLnN0YXR1cyA9PT0gQURBUFRFUl9TVEFUVVMuQ09OTkVDVEVEICYmIHRoaXMucHJvdmlkZXIpIHJldHVybiB0aGlzLnByb3ZpZGVyO1xuICAgIHRoaXMubG9naW5Nb2RhbC5vcGVuKCk7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHRoaXMub25jZShBREFQVEVSX0VWRU5UUy5DT05ORUNURUQsICgpID0+IHtcbiAgICAgICAgcmV0dXJuIHJlc29sdmUodGhpcy5wcm92aWRlcik7XG4gICAgICB9KTtcbiAgICAgIHRoaXMub25jZShBREFQVEVSX0VWRU5UUy5FUlJPUkVELCBlcnIgPT4ge1xuICAgICAgICByZXR1cm4gcmVqZWN0KGVycik7XG4gICAgICB9KTtcbiAgICAgIHRoaXMub25jZShMT0dJTl9NT0RBTF9FVkVOVFMuTU9EQUxfVklTSUJJTElUWSwgdmlzaWJpbGl0eSA9PiB7XG4gICAgICAgIC8vIG1vZGFsIGlzIGNsb3NlZCBidXQgdXNlciBpcyBub3QgY29ubmVjdGVkIHRvIGFueSB3YWxsZXQuXG4gICAgICAgIGlmICghdmlzaWJpbGl0eSAmJiB0aGlzLnN0YXR1cyAhPT0gQURBUFRFUl9TVEFUVVMuQ09OTkVDVEVEKSB7XG4gICAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoXCJVc2VyIGNsb3NlZCB0aGUgbW9kYWxcIikpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICBhc3luYyBpbml0RXh0ZXJuYWxXYWxsZXRBZGFwdGVycyhleHRlcm5hbFdhbGxldHNJbml0aWFsaXplZCwgb3B0aW9ucykge1xuICAgIGlmIChleHRlcm5hbFdhbGxldHNJbml0aWFsaXplZCkgcmV0dXJuO1xuICAgIGNvbnN0IGFkYXB0ZXJzQ29uZmlnID0ge307XG4gICAgT2JqZWN0LmtleXModGhpcy53YWxsZXRBZGFwdGVycykuZm9yRWFjaChhc3luYyBhZGFwdGVyTmFtZSA9PiB7XG4gICAgICBjb25zdCBhZGFwdGVyID0gdGhpcy53YWxsZXRBZGFwdGVyc1thZGFwdGVyTmFtZV07XG4gICAgICBpZiAoKGFkYXB0ZXIgPT09IG51bGwgfHwgYWRhcHRlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogYWRhcHRlci50eXBlKSA9PT0gQURBUFRFUl9DQVRFR09SWS5FWFRFUk5BTCkge1xuICAgICAgICBsb2cuZGVidWcoXCJpbml0IGV4dGVybmFsIHdhbGxldFwiLCB0aGlzLmNhY2hlZEFkYXB0ZXIsIGFkYXB0ZXJOYW1lKTtcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVUb0FkYXB0ZXJFdmVudHMoYWRhcHRlcik7XG4gICAgICAgIC8vIHdlIGFyZSBub3QgaW5pdGlhbGl6aW5nIGNhY2hlZCBhZGFwdGVyIGhlcmUgYXMgaXQgaXMgYWxyZWFkeSBiZWluZyBpbml0aWFsaXplZCBpbiBpbml0TW9kYWwgYmVmb3JlLlxuICAgICAgICBpZiAodGhpcy5jYWNoZWRBZGFwdGVyID09PSBhZGFwdGVyTmFtZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYWRhcHRlci5zdGF0dXMgPT09IEFEQVBURVJfU1RBVFVTLk5PVF9SRUFEWSkge1xuICAgICAgICAgIGF3YWl0IGFkYXB0ZXIuaW5pdCh7XG4gICAgICAgICAgICBhdXRvQ29ubmVjdDogdGhpcy5jYWNoZWRBZGFwdGVyID09PSBhZGFwdGVyTmFtZVxuICAgICAgICAgIH0pLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgYWRhcHRlcnNDb25maWdbYWRhcHRlck5hbWVdID0gdGhpcy5tb2RhbENvbmZpZy5hZGFwdGVyc1thZGFwdGVyTmFtZV07XG4gICAgICAgICAgICB0aGlzLmxvZ2luTW9kYWwuYWRkV2FsbGV0TG9naW5zKGFkYXB0ZXJzQ29uZmlnLCB7XG4gICAgICAgICAgICAgIHNob3dFeHRlcm5hbFdhbGxldHNPbmx5OiAhIShvcHRpb25zICE9PSBudWxsICYmIG9wdGlvbnMgIT09IHZvaWQgMCAmJiBvcHRpb25zLnNob3dFeHRlcm5hbFdhbGxldHNPbmx5KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgIH0pLmNhdGNoKGVycm9yID0+IGxvZy5lcnJvcihlcnJvciwgXCJlcnJvciB3aGlsZSBpbml0aWFsaXppbmcgYWRhcHRlclwiLCBhZGFwdGVyTmFtZSkpO1xuICAgICAgICB9IGVsc2UgaWYgKGFkYXB0ZXIuc3RhdHVzID09PSBBREFQVEVSX1NUQVRVUy5SRUFEWSkge1xuICAgICAgICAgIGFkYXB0ZXJzQ29uZmlnW2FkYXB0ZXJOYW1lXSA9IHRoaXMubW9kYWxDb25maWcuYWRhcHRlcnNbYWRhcHRlck5hbWVdO1xuICAgICAgICAgIHRoaXMubG9naW5Nb2RhbC5hZGRXYWxsZXRMb2dpbnMoYWRhcHRlcnNDb25maWcsIHtcbiAgICAgICAgICAgIHNob3dFeHRlcm5hbFdhbGxldHNPbmx5OiAhIShvcHRpb25zICE9PSBudWxsICYmIG9wdGlvbnMgIT09IHZvaWQgMCAmJiBvcHRpb25zLnNob3dFeHRlcm5hbFdhbGxldHNPbmx5KVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgaW5pdGlhbGl6ZUluQXBwV2FsbGV0KGFkYXB0ZXJOYW1lKSB7XG4gICAgbG9nLmluZm8oXCJhZGFwdGVySW5pdFJlc3VsdHNcIiwgYWRhcHRlck5hbWUpO1xuICAgIGlmICh0aGlzLndhbGxldEFkYXB0ZXJzW2FkYXB0ZXJOYW1lXS50eXBlID09PSBBREFQVEVSX0NBVEVHT1JZLklOX0FQUCkge1xuICAgICAgdmFyIF9hZGFwdGVyTmFtZSwgX3RoaXMkb3B0aW9ucyR1aUNvbmZpMiwgX3RoaXMkb3B0aW9ucyR1aUNvbmZpMywgX3RoaXMkb3B0aW9ucyR1aUNvbmZpNDtcbiAgICAgIHRoaXMubG9naW5Nb2RhbC5hZGRTb2NpYWxMb2dpbnMoYWRhcHRlck5hbWUsIGdldEFkYXB0ZXJTb2NpYWxMb2dpbnMoYWRhcHRlck5hbWUsIChfYWRhcHRlck5hbWUgPSB0aGlzLm1vZGFsQ29uZmlnLmFkYXB0ZXJzW2FkYXB0ZXJOYW1lXSkgPT09IG51bGwgfHwgX2FkYXB0ZXJOYW1lID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYWRhcHRlck5hbWUubG9naW5NZXRob2RzKSwgKChfdGhpcyRvcHRpb25zJHVpQ29uZmkyID0gdGhpcy5vcHRpb25zLnVpQ29uZmlnKSA9PT0gbnVsbCB8fCBfdGhpcyRvcHRpb25zJHVpQ29uZmkyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRvcHRpb25zJHVpQ29uZmkyLmxvZ2luTWV0aG9kc09yZGVyKSB8fCBPUEVOTE9HSU5fUFJPVklERVJTLCBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHRoaXMub3B0aW9ucy51aUNvbmZpZyksIHt9LCB7XG4gICAgICAgIGxvZ2luR3JpZENvbDogKChfdGhpcyRvcHRpb25zJHVpQ29uZmkzID0gdGhpcy5vcHRpb25zLnVpQ29uZmlnKSA9PT0gbnVsbCB8fCBfdGhpcyRvcHRpb25zJHVpQ29uZmkzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRvcHRpb25zJHVpQ29uZmkzLmxvZ2luR3JpZENvbCkgfHwgMyxcbiAgICAgICAgcHJpbWFyeUJ1dHRvbjogKChfdGhpcyRvcHRpb25zJHVpQ29uZmk0ID0gdGhpcy5vcHRpb25zLnVpQ29uZmlnKSA9PT0gbnVsbCB8fCBfdGhpcyRvcHRpb25zJHVpQ29uZmk0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRvcHRpb25zJHVpQ29uZmk0LnByaW1hcnlCdXR0b24pIHx8IFwic29jaWFsTG9naW5cIlxuICAgICAgfSkpO1xuICAgIH1cbiAgfVxuICBzdWJzY3JpYmVUb0xvZ2luTW9kYWxFdmVudHMoKSB7XG4gICAgdGhpcy5sb2dpbk1vZGFsLm9uKExPR0lOX01PREFMX0VWRU5UUy5MT0dJTiwgYXN5bmMgcGFyYW1zID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHRoaXMuY29ubmVjdFRvKHBhcmFtcy5hZGFwdGVyLCBwYXJhbXMubG9naW5QYXJhbXMpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nLmVycm9yKGBFcnJvciB3aGlsZSBjb25uZWN0aW5nIHRvIGFkYXB0ZXI6ICR7cGFyYW1zLmFkYXB0ZXJ9YCwgZXJyb3IpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMubG9naW5Nb2RhbC5vbihMT0dJTl9NT0RBTF9FVkVOVFMuSU5JVF9FWFRFUk5BTF9XQUxMRVRTLCBhc3luYyBwYXJhbXMgPT4ge1xuICAgICAgYXdhaXQgdGhpcy5pbml0RXh0ZXJuYWxXYWxsZXRBZGFwdGVycyhwYXJhbXMuZXh0ZXJuYWxXYWxsZXRzSW5pdGlhbGl6ZWQpO1xuICAgIH0pO1xuICAgIHRoaXMubG9naW5Nb2RhbC5vbihMT0dJTl9NT0RBTF9FVkVOVFMuRElTQ09OTkVDVCwgYXN5bmMgKCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgdGhpcy5sb2dvdXQoKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZy5lcnJvcihgRXJyb3Igd2hpbGUgZGlzY29ubmVjdGluZ2AsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLmxvZ2luTW9kYWwub24oTE9HSU5fTU9EQUxfRVZFTlRTLk1PREFMX1ZJU0lCSUxJVFksIGFzeW5jIHZpc2liaWxpdHkgPT4ge1xuICAgICAgbG9nLmRlYnVnKFwiaXMgbG9naW4gbW9kYWwgdmlzaWJsZVwiLCB2aXNpYmlsaXR5KTtcbiAgICAgIHRoaXMuZW1pdChMT0dJTl9NT0RBTF9FVkVOVFMuTU9EQUxfVklTSUJJTElUWSwgdmlzaWJpbGl0eSk7XG4gICAgICBjb25zdCBhZGFwdGVyID0gdGhpcy53YWxsZXRBZGFwdGVyc1tXQUxMRVRfQURBUFRFUlMuV0FMTEVUX0NPTk5FQ1RfVjJdO1xuICAgICAgaWYgKGFkYXB0ZXIpIHtcbiAgICAgICAgY29uc3Qgd2FsbGV0Q29ubmVjdFN0YXR1cyA9IGFkYXB0ZXIgPT09IG51bGwgfHwgYWRhcHRlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogYWRhcHRlci5zdGF0dXM7XG4gICAgICAgIGxvZy5kZWJ1ZyhcInRyeWluZyByZWZyZXNoaW5nIHdjIHNlc3Npb25cIiwgdmlzaWJpbGl0eSwgd2FsbGV0Q29ubmVjdFN0YXR1cyk7XG4gICAgICAgIGlmICh2aXNpYmlsaXR5ICYmICh3YWxsZXRDb25uZWN0U3RhdHVzID09PSBBREFQVEVSX1NUQVRVUy5SRUFEWSB8fCB3YWxsZXRDb25uZWN0U3RhdHVzID09PSBBREFQVEVSX1NUQVRVUy5DT05ORUNUSU5HKSkge1xuICAgICAgICAgIGxvZy5kZWJ1ZyhcInJlZnJlc2hpbmcgd2Mgc2Vzc2lvblwiKTtcblxuICAgICAgICAgIC8vIHJlZnJlc2hpbmcgc2Vzc2lvbiBmb3Igd2FsbGV0IGNvbm5lY3Qgd2hlbmV2ZXIgbW9kYWwgaXMgb3BlbmVkLlxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhZGFwdGVyLmNvbm5lY3QoKTtcbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgbG9nLmVycm9yKGBFcnJvciB3aGlsZSBkaXNjb25uZWN0aW5nIHRvIHdhbGxldCBjb25uZWN0IGluIGNvcmVgLCBlcnJvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghdmlzaWJpbGl0eSAmJiB0aGlzLnN0YXR1cyA9PT0gQURBUFRFUl9TVEFUVVMuQ09OTkVDVEVEICYmICh3YWxsZXRDb25uZWN0U3RhdHVzID09PSBBREFQVEVSX1NUQVRVUy5SRUFEWSB8fCB3YWxsZXRDb25uZWN0U3RhdHVzID09PSBBREFQVEVSX1NUQVRVUy5DT05ORUNUSU5HKSkge1xuICAgICAgICAgIGxvZy5kZWJ1ZyhcInRoaXMgc3RvcHMgd2MgYWRhcHRlciBmcm9tIHRyeWluZyB0byByZWNvbm5lY3Qgb25jZSBwcm9wb3NhbCBleHBpcmVzXCIpO1xuICAgICAgICAgIGFkYXB0ZXIuc3RhdHVzID0gQURBUFRFUl9TVEFUVVMuUkVBRFk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgeyBXZWIzQXV0aCwgZGVmYXVsdEV2bURhcHBNb2RhbENvbmZpZywgZGVmYXVsdEV2bVdhbGxldE1vZGFsQ29uZmlnLCBkZWZhdWx0T3RoZXJNb2RhbENvbmZpZywgZGVmYXVsdFNvbGFuYURhcHBNb2RhbENvbmZpZywgZGVmYXVsdFNvbGFuYVdhbGxldE1vZGFsQ29uZmlnIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/../../node_modules/.pnpm/@web3auth+modal@8.12.7_@babel+runtime@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1_typescript@5.6.3/node_modules/@web3auth/modal/dist/modal.esm.js\n");

/***/ })

};
;