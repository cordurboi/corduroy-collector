"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@toruslabs+openlogin@8.2.1_@babel+runtime@7.28.4";
exports.ids = ["vendor-chunks/@toruslabs+openlogin@8.2.1_@babel+runtime@7.28.4"];
exports.modules = {

/***/ "(ssr)/../../node_modules/.pnpm/@toruslabs+openlogin@8.2.1_@babel+runtime@7.28.4/node_modules/@toruslabs/openlogin/dist/openlogin.esm.js":
/*!*****************************************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/@toruslabs+openlogin@8.2.1_@babel+runtime@7.28.4/node_modules/@toruslabs/openlogin/dist/openlogin.esm.js ***!
  \*****************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   InitializationError: () => (/* binding */ InitializationError),\n/* harmony export */   LoginError: () => (/* binding */ LoginError),\n/* harmony export */   OpenloginError: () => (/* binding */ OpenloginError),\n/* harmony export */   constructURL: () => (/* binding */ constructURL),\n/* harmony export */   \"default\": () => (/* binding */ OpenLogin),\n/* harmony export */   getHashQueryParams: () => (/* binding */ getHashQueryParams),\n/* harmony export */   getPopupFeatures: () => (/* binding */ getPopupFeatures),\n/* harmony export */   getTimeout: () => (/* binding */ getTimeout),\n/* harmony export */   isMobileOrTablet: () => (/* binding */ isMobileOrTablet),\n/* harmony export */   loglevel: () => (/* binding */ loglevel),\n/* harmony export */   version: () => (/* binding */ version),\n/* harmony export */   whitelistUrl: () => (/* binding */ whitelistUrl)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"(ssr)/../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/defineProperty.js\");\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var ts_custom_error__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ts-custom-error */ \"(ssr)/../../node_modules/.pnpm/ts-custom-error@3.3.1/node_modules/ts-custom-error/dist/custom-error.mjs\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! loglevel */ \"(ssr)/../../node_modules/.pnpm/loglevel@1.9.2/node_modules/loglevel/lib/loglevel.js\");\n/* harmony import */ var loglevel__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime/helpers/objectSpread2 */ \"(ssr)/../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/objectSpread2.js\");\n/* harmony import */ var _babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _toruslabs_constants__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @toruslabs/constants */ \"(ssr)/../../node_modules/.pnpm/@toruslabs+constants@13.4.0_@babel+runtime@7.28.4/node_modules/@toruslabs/constants/dist/constants.esm.js\");\n/* harmony import */ var _toruslabs_openlogin_session_manager__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @toruslabs/openlogin-session-manager */ \"(ssr)/../../node_modules/.pnpm/@toruslabs+openlogin-session-manager@3.1.1_@babel+runtime@7.28.4/node_modules/@toruslabs/openlogin-session-manager/dist/openloginSessionManager.esm.js\");\n/* harmony import */ var _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @toruslabs/openlogin-utils */ \"(ssr)/../../node_modules/.pnpm/@toruslabs+openlogin-utils@8.2.1_@babel+runtime@7.28.4/node_modules/@toruslabs/openlogin-utils/dist/openloginUtils.esm.js\");\n/* harmony import */ var _toruslabs_secure_pub_sub__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @toruslabs/secure-pub-sub */ \"(ssr)/../../node_modules/.pnpm/@toruslabs+secure-pub-sub@0.2.0_@babel+runtime@7.28.4/node_modules/@toruslabs/secure-pub-sub/dist/securePubSub.esm.js\");\n/* harmony import */ var events__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! events */ \"events\");\n/* harmony import */ var events__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(events__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var _toruslabs_eccrypto__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @toruslabs/eccrypto */ \"(ssr)/../../node_modules/.pnpm/@toruslabs+eccrypto@4.0.0/node_modules/@toruslabs/eccrypto/dist/eccrypto.esm.js\");\n/* harmony import */ var _toruslabs_metadata_helpers__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @toruslabs/metadata-helpers */ \"(ssr)/../../node_modules/.pnpm/@toruslabs+metadata-helpers@5.1.0_@babel+runtime@7.28.4/node_modules/@toruslabs/metadata-helpers/dist/metadataHelpers.esm.js\");\n/* harmony import */ var bowser__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! bowser */ \"(ssr)/../../node_modules/.pnpm/bowser@2.12.1/node_modules/bowser/src/bowser.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\nclass OpenloginError extends ts_custom_error__WEBPACK_IMPORTED_MODULE_1__.CustomError {\n  constructor(code, message) {\n    // takes care of stack and proto\n    super(message);\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"code\", void 0);\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"message\", void 0);\n    this.code = code;\n    this.message = message || \"\";\n    // Set name explicitly as minification can mangle class names\n    Object.defineProperty(this, \"name\", {\n      value: \"OpenloginError\"\n    });\n  }\n  toJSON() {\n    return {\n      name: this.name,\n      code: this.code,\n      message: this.message\n    };\n  }\n  toString() {\n    return JSON.stringify(this.toJSON());\n  }\n}\nclass InitializationError extends OpenloginError {\n  constructor(code, message) {\n    // takes care of stack and proto\n    super(code, message);\n\n    // Set name explicitly as minification can mangle class names\n    Object.defineProperty(this, \"name\", {\n      value: \"InitializationError\"\n    });\n  }\n  static fromCode(code) {\n    let extraMessage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n    return new InitializationError(code, `${InitializationError.messages[code]}, ${extraMessage}`);\n  }\n  static invalidParams() {\n    let extraMessage = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n    return InitializationError.fromCode(5001, extraMessage);\n  }\n  static notInitialized() {\n    let extraMessage = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n    return InitializationError.fromCode(5002, extraMessage);\n  }\n}\n\n/**\n * login errors\n */\n_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(InitializationError, \"messages\", {\n  5000: \"Custom\",\n  5001: \"Invalid constructor params\",\n  5002: \"SDK not initialized. please call init first\"\n});\nclass LoginError extends OpenloginError {\n  constructor(code, message) {\n    // takes care of stack and proto\n    super(code, message);\n\n    // Set name explicitly as minification can mangle class names\n    Object.defineProperty(this, \"name\", {\n      value: \"LoginError\"\n    });\n  }\n  static fromCode(code) {\n    let extraMessage = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n    return new LoginError(code, `${LoginError.messages[code]}, ${extraMessage}`);\n  }\n  static invalidLoginParams() {\n    let extraMessage = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n    return LoginError.fromCode(5111, extraMessage);\n  }\n  static userNotLoggedIn() {\n    let extraMessage = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n    return LoginError.fromCode(5112, extraMessage);\n  }\n  static popupClosed() {\n    let extraMessage = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n    return LoginError.fromCode(5113, extraMessage);\n  }\n  static loginFailed() {\n    let extraMessage = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n    return LoginError.fromCode(5114, extraMessage);\n  }\n  static popupBlocked() {\n    let extraMessage = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n    return LoginError.fromCode(5115, extraMessage);\n  }\n  static mfaAlreadyEnabled() {\n    let extraMessage = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n    return LoginError.fromCode(5116, extraMessage);\n  }\n  static mfaNotEnabled() {\n    let extraMessage = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n    return LoginError.fromCode(5117, extraMessage);\n  }\n}\n_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(LoginError, \"messages\", {\n  5000: \"Custom\",\n  5111: \"Invalid login params\",\n  5112: \"User not logged in.\",\n  5113: \"login popup has been closed by the user\",\n  5114: \"Login failed\",\n  5115: \"Popup was blocked. Please call this function as soon as user clicks button or use redirect mode\",\n  5116: \"MFA already enabled\",\n  5117: \"MFA not yet enabled. Please call `enableMFA` first\"\n});\n\nconst loglevel = (0,loglevel__WEBPACK_IMPORTED_MODULE_2__.getLogger)(\"openlogin\");\nloglevel.setLevel(\"error\");\n\n// don't use destructuring for process.env cause it messes up webpack env plugin\nconst version = \"8.2.1\";\nasync function whitelistUrl(clientId, appKey, origin) {\n  const appKeyBuf = Buffer.from(appKey.padStart(64, \"0\"), \"hex\");\n  if (_toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.base64url.encode((0,_toruslabs_eccrypto__WEBPACK_IMPORTED_MODULE_9__.getPublic)(appKeyBuf)) !== clientId) throw new Error(\"appKey mismatch\");\n  const sig = await (0,_toruslabs_eccrypto__WEBPACK_IMPORTED_MODULE_9__.sign)(appKeyBuf, (0,_toruslabs_metadata_helpers__WEBPACK_IMPORTED_MODULE_10__.keccak256)(Buffer.from(origin, \"utf8\")));\n  return _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.base64url.encode(sig);\n}\nfunction getHashQueryParams() {\n  let replaceUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n  const result = {};\n  const queryUrlParams = new URLSearchParams(window.location.search.slice(1));\n  queryUrlParams.forEach((value, key) => {\n    if (key !== \"b64Params\") {\n      result[key] = value;\n    }\n  });\n  const queryResult = queryUrlParams.get(\"b64Params\");\n  if (queryResult) {\n    try {\n      const queryParams = JSON.parse((0,_toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.safeatob)(queryResult));\n      Object.keys(queryParams).forEach(key => {\n        result[key] = queryParams[key];\n      });\n    } catch (error) {\n      loglevel.error(error);\n    }\n  }\n  const hashUrlParams = new URLSearchParams(window.location.hash.substring(1));\n  hashUrlParams.forEach((value, key) => {\n    if (key !== \"b64Params\") {\n      result[key] = value;\n    }\n  });\n  const hashResult = hashUrlParams.get(\"b64Params\");\n  if (hashResult) {\n    try {\n      const hashParams = JSON.parse((0,_toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.safeatob)(hashResult));\n      Object.keys(hashParams).forEach(key => {\n        result[key] = hashParams[key];\n      });\n    } catch (error) {\n      loglevel.error(error);\n    }\n  }\n  if (replaceUrl) {\n    const cleanUrl = new URL(window.location.origin + window.location.pathname);\n    // https://dapp.com/#b64Params=asacsdnvdfv&state=sldjvndfkjvn&dappValue=sdjvndf\n    if (queryUrlParams.size > 0) {\n      queryUrlParams.delete(\"error\");\n      queryUrlParams.delete(\"state\");\n      queryUrlParams.delete(\"b64Params\");\n      queryUrlParams.delete(\"sessionNamespace\");\n      cleanUrl.search = queryUrlParams.toString();\n    }\n    if (hashUrlParams.size > 0) {\n      hashUrlParams.delete(\"error\");\n      hashUrlParams.delete(\"state\");\n      hashUrlParams.delete(\"b64Params\");\n      hashUrlParams.delete(\"sessionNamespace\");\n      cleanUrl.hash = hashUrlParams.toString();\n    }\n    window.history.replaceState(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_3___default()(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_3___default()({}, window.history.state), {}, {\n      as: cleanUrl.href,\n      url: cleanUrl.href\n    }), \"\", cleanUrl.href);\n  }\n  return result;\n}\nfunction constructURL(params) {\n  const {\n    baseURL,\n    query,\n    hash\n  } = params;\n  const url = new URL(baseURL);\n  if (query) {\n    Object.keys(query).forEach(key => {\n      url.searchParams.append(key, query[key]);\n    });\n  }\n  if (hash) {\n    const h = new URL(constructURL({\n      baseURL,\n      query: hash\n    })).searchParams.toString();\n    url.hash = h;\n  }\n  return url.toString();\n}\nfunction getPopupFeatures() {\n  if (typeof window === \"undefined\") return \"\";\n  // Fixes dual-screen position                             Most browsers      Firefox\n  const dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : window.screenX;\n  const dualScreenTop = window.screenTop !== undefined ? window.screenTop : window.screenY;\n  const w = 1200;\n  const h = 700;\n  const width = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : window.screen.width;\n  const height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : window.screen.height;\n  const systemZoom = 1; // No reliable estimate\n\n  const left = Math.abs((width - w) / 2 / systemZoom + dualScreenLeft);\n  const top = Math.abs((height - h) / 2 / systemZoom + dualScreenTop);\n  const features = `titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=${h / systemZoom},width=${w / systemZoom},top=${top},left=${left}`;\n  return features;\n}\nfunction isMobileOrTablet() {\n  if (typeof window === \"undefined\") return false;\n  const browser = bowser__WEBPACK_IMPORTED_MODULE_11__[\"default\"].getParser(window.navigator.userAgent);\n  const platform = browser.getPlatform();\n  return platform.type === bowser__WEBPACK_IMPORTED_MODULE_11__[\"default\"].PLATFORMS_MAP.tablet || platform.type === bowser__WEBPACK_IMPORTED_MODULE_11__[\"default\"].PLATFORMS_MAP.mobile;\n}\nfunction getTimeout(loginProvider) {\n  if ((loginProvider === _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.LOGIN_PROVIDER.FACEBOOK || loginProvider === _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.LOGIN_PROVIDER.LINE) && isMobileOrTablet()) {\n    return 1000 * 60 * 5; // 5 minutes to finish the login\n  }\n  return 1000 * 10; // 10 seconds\n}\n\nclass PopupHandler extends events__WEBPACK_IMPORTED_MODULE_8__.EventEmitter {\n  constructor(_ref) {\n    let {\n      url,\n      target,\n      features,\n      timeout = 30000\n    } = _ref;\n    super();\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"url\", void 0);\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"target\", void 0);\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"features\", void 0);\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"window\", void 0);\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"windowTimer\", void 0);\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"iClosedWindow\", void 0);\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"timeout\", void 0);\n    this.url = url;\n    this.target = target || \"_blank\";\n    this.features = features || getPopupFeatures();\n    this.window = undefined;\n    this.windowTimer = undefined;\n    this.iClosedWindow = false;\n    this.timeout = timeout;\n    this._setupTimer();\n  }\n  _setupTimer() {\n    this.windowTimer = Number(setInterval(() => {\n      if (this.window && this.window.closed) {\n        clearInterval(this.windowTimer);\n        setTimeout(() => {\n          if (!this.iClosedWindow) {\n            this.emit(\"close\");\n          }\n          this.iClosedWindow = false;\n          this.window = undefined;\n        }, this.timeout);\n      }\n      if (this.window === undefined) clearInterval(this.windowTimer);\n    }, 500));\n  }\n  open() {\n    var _this$window;\n    this.window = window.open(this.url, this.target, this.features);\n    if (!this.window) throw LoginError.popupBlocked();\n    if ((_this$window = this.window) !== null && _this$window !== void 0 && _this$window.focus) this.window.focus();\n  }\n  close() {\n    this.iClosedWindow = true;\n    if (this.window) this.window.close();\n  }\n  redirect(locationReplaceOnRedirect) {\n    if (locationReplaceOnRedirect) {\n      window.location.replace(this.url);\n    } else {\n      window.location.href = this.url;\n    }\n  }\n  async listenOnChannel(loginId) {\n    const securePubSub = new _toruslabs_secure_pub_sub__WEBPACK_IMPORTED_MODULE_7__.SecurePubSub();\n    const data = await securePubSub.subscribe(loginId);\n    this.close();\n    securePubSub.cleanup();\n    const parsedData = JSON.parse(data);\n    if (parsedData.error) {\n      return {\n        error: parsedData.error,\n        state: parsedData.state\n      };\n    }\n    return parsedData.data;\n  }\n}\n\nclass OpenLogin {\n  constructor(options) {\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"state\", {});\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"options\", void 0);\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"sessionManager\", void 0);\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"currentStorage\", void 0);\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"_storageBaseKey\", \"openlogin_store\");\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"dappState\", void 0);\n    _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this, \"addVersionInUrls\", true);\n    if (!options.clientId) throw InitializationError.invalidParams(\"clientId is required\");\n    if (!options.network) options.network = _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.OPENLOGIN_NETWORK.SAPPHIRE_MAINNET;\n    if (!options.buildEnv) options.buildEnv = _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.BUILD_ENV.PRODUCTION;\n    if (options.buildEnv === _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.BUILD_ENV.DEVELOPMENT || options.buildEnv === _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.BUILD_ENV.TESTING || options.sdkUrl) this.addVersionInUrls = false;\n    if (!options.sdkUrl && !options.useMpc) {\n      if (options.buildEnv === _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.BUILD_ENV.DEVELOPMENT) {\n        options.sdkUrl = \"http://localhost:3000\";\n        options.dashboardUrl = \"http://localhost:5173/wallet/account\";\n      } else if (options.buildEnv === _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.BUILD_ENV.STAGING) {\n        options.sdkUrl = \"https://staging-auth.web3auth.io\";\n        options.dashboardUrl = \"https://staging-account.web3auth.io/wallet/account\";\n      } else if (options.buildEnv === _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.BUILD_ENV.TESTING) {\n        options.sdkUrl = \"https://develop-auth.web3auth.io\";\n        options.dashboardUrl = \"https://develop-account.web3auth.io/wallet/account\";\n      } else {\n        options.sdkUrl = \"https://auth.web3auth.io\";\n        options.dashboardUrl = \"https://account.web3auth.io/wallet/account\";\n      }\n    }\n    if (options.useMpc && !options.sdkUrl) {\n      if (Object.values(_toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.TORUS_LEGACY_NETWORK).includes(options.network)) throw InitializationError.invalidParams(\"MPC is not supported on legacy networks, please use sapphire_devnet or sapphire_mainnet.\");\n      if (options.buildEnv === _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.BUILD_ENV.DEVELOPMENT) {\n        options.sdkUrl = \"http://localhost:3000\";\n      } else if (options.buildEnv === _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.BUILD_ENV.STAGING) {\n        options.sdkUrl = \"https://staging-mpc-auth.web3auth.io\";\n      } else if (options.buildEnv === _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.BUILD_ENV.TESTING) {\n        options.sdkUrl = \"https://develop-mpc-auth.web3auth.io\";\n      } else {\n        options.sdkUrl = \"https://mpc-auth.web3auth.io\";\n      }\n    }\n    if (!options.redirectUrl && typeof window !== \"undefined\") {\n      options.redirectUrl = `${window.location.protocol}//${window.location.host}${window.location.pathname}`;\n    }\n    if (!options.uxMode) options.uxMode = _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.UX_MODE.REDIRECT;\n    if (typeof options.replaceUrlOnRedirect !== \"boolean\") options.replaceUrlOnRedirect = true;\n    if (!options.originData) options.originData = {};\n    if (!options.whiteLabel) options.whiteLabel = {};\n    if (!options.loginConfig) options.loginConfig = {};\n    if (!options.mfaSettings) options.mfaSettings = {};\n    if (!options.storageServerUrl) options.storageServerUrl = _toruslabs_constants__WEBPACK_IMPORTED_MODULE_4__.SESSION_SERVER;\n    if (!options.storageKey) options.storageKey = \"local\";\n    if (!options.webauthnTransports) options.webauthnTransports = [\"internal\"];\n    if (!options.sessionTime) options.sessionTime = 86400;\n    this.options = options;\n  }\n  get privKey() {\n    if (this.options.useMpc) return this.state.factorKey || \"\";\n    return this.state.privKey ? this.state.privKey.padStart(64, \"0\") : \"\";\n  }\n  get coreKitKey() {\n    return this.state.coreKitKey ? this.state.coreKitKey.padStart(64, \"0\") : \"\";\n  }\n  get ed25519PrivKey() {\n    return this.state.ed25519PrivKey ? this.state.ed25519PrivKey.padStart(128, \"0\") : \"\";\n  }\n  get coreKitEd25519Key() {\n    return this.state.coreKitEd25519PrivKey ? this.state.coreKitEd25519PrivKey.padStart(128, \"0\") : \"\";\n  }\n  get sessionId() {\n    return this.state.sessionId || \"\";\n  }\n  get sessionNamespace() {\n    return this.options.sessionNamespace || \"\";\n  }\n  get appState() {\n    return this.state.userInfo.appState || this.dappState || \"\";\n  }\n  get baseUrl() {\n    // testing and develop don't have versioning\n    if (!this.addVersionInUrls) return `${this.options.sdkUrl}`;\n    return `${this.options.sdkUrl}/v${version.split(\".\")[0]}`;\n  }\n  async init() {\n    // get sessionNamespace from the redirect result.\n    const params = getHashQueryParams(this.options.replaceUrlOnRedirect);\n    if (params.sessionNamespace) this.options.sessionNamespace = params.sessionNamespace;\n    const storageKey = this.options.sessionNamespace ? `${this._storageBaseKey}_${this.options.sessionNamespace}` : this._storageBaseKey;\n    this.currentStorage = _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.BrowserStorage.getInstance(storageKey, this.options.storageKey);\n    const sessionId = this.currentStorage.get(\"sessionId\");\n    this.sessionManager = new _toruslabs_openlogin_session_manager__WEBPACK_IMPORTED_MODULE_5__.OpenloginSessionManager({\n      sessionServerBaseUrl: this.options.storageServerUrl,\n      sessionNamespace: this.options.sessionNamespace,\n      sessionTime: this.options.sessionTime,\n      sessionId\n    });\n    if (this.options.network === _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.OPENLOGIN_NETWORK.TESTNET || this.options.network === _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.OPENLOGIN_NETWORK.SAPPHIRE_DEVNET) {\n      // using console log because it shouldn't be affected by loglevel config\n      // eslint-disable-next-line no-console\n      console.log(`%c WARNING! You are on ${this.options.network}. Please set network: 'mainnet' or 'sapphire_mainnet' in production`, \"color: #FF0000\");\n    }\n    if (this.options.buildEnv !== _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.BUILD_ENV.PRODUCTION) {\n      // using console log because it shouldn't be affected by loglevel config\n      // eslint-disable-next-line no-console\n      console.log(`%c WARNING! You are using build env ${this.options.buildEnv}. Please set buildEnv: 'production' in production`, \"color: #FF0000\");\n    }\n    if (params.error) {\n      this.dappState = params.state;\n      throw LoginError.loginFailed(params.error);\n    }\n    if (params.sessionId) {\n      this.currentStorage.set(\"sessionId\", params.sessionId);\n      this.sessionManager.sessionId = params.sessionId;\n    }\n    if (this.sessionManager.sessionId) {\n      const data = await this._authorizeSession();\n      // Fill state with correct info from session\n      // If session is invalid all the data is unset here.\n      this.updateState(data);\n      if (Object.keys(data).length === 0) {\n        // If session is invalid, unset the sessionId from localStorage.\n        this.currentStorage.set(\"sessionId\", \"\");\n      }\n    }\n  }\n  async login(params) {\n    if (!params.loginProvider) throw LoginError.invalidLoginParams(`loginProvider is required`);\n\n    // in case of redirect mode, redirect url will be dapp specified\n    // in case of popup mode, redirect url will be sdk specified\n    const defaultParams = {\n      redirectUrl: this.options.redirectUrl\n    };\n    const loginParams = _babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_3___default()(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_3___default()({\n      loginProvider: params.loginProvider\n    }, defaultParams), params);\n    const dataObject = {\n      actionType: _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.OPENLOGIN_ACTIONS.LOGIN,\n      options: this.options,\n      params: loginParams\n    };\n    const result = await this.openloginHandler(`${this.baseUrl}/start`, dataObject, getTimeout(params.loginProvider));\n    if (this.options.uxMode === _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.UX_MODE.REDIRECT) return null;\n    if (result.error) {\n      this.dappState = result.state;\n      throw LoginError.loginFailed(result.error);\n    }\n    this.sessionManager.sessionId = result.sessionId;\n    this.options.sessionNamespace = result.sessionNamespace;\n    this.currentStorage.set(\"sessionId\", result.sessionId);\n    await this.rehydrateSession();\n    return {\n      privKey: this.privKey\n    };\n  }\n  async logout() {\n    if (!this.sessionManager.sessionId) throw LoginError.userNotLoggedIn();\n    await this.sessionManager.invalidateSession();\n    this.updateState({\n      privKey: \"\",\n      coreKitKey: \"\",\n      coreKitEd25519PrivKey: \"\",\n      ed25519PrivKey: \"\",\n      walletKey: \"\",\n      oAuthPrivateKey: \"\",\n      tKey: \"\",\n      metadataNonce: \"\",\n      keyMode: undefined,\n      userInfo: {\n        name: \"\",\n        profileImage: \"\",\n        dappShare: \"\",\n        idToken: \"\",\n        oAuthIdToken: \"\",\n        oAuthAccessToken: \"\",\n        appState: \"\",\n        email: \"\",\n        verifier: \"\",\n        verifierId: \"\",\n        aggregateVerifier: \"\",\n        typeOfLogin: \"\",\n        isMfaEnabled: false\n      },\n      authToken: \"\",\n      sessionId: \"\",\n      factorKey: \"\",\n      signatures: [],\n      tssShareIndex: -1,\n      tssPubKey: \"\",\n      tssShare: \"\",\n      tssNonce: -1\n    });\n    this.currentStorage.set(\"sessionId\", \"\");\n  }\n  async enableMFA(params) {\n    var _this$state$userInfo;\n    if (!this.sessionId) throw LoginError.userNotLoggedIn();\n    if (this.state.userInfo.isMfaEnabled) throw LoginError.mfaAlreadyEnabled();\n    // in case of redirect mode, redirect url will be dapp specified\n    // in case of popup mode, redirect url will be sdk specified\n    const defaultParams = {\n      redirectUrl: this.options.redirectUrl\n    };\n    const dataObject = {\n      actionType: _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.OPENLOGIN_ACTIONS.ENABLE_MFA,\n      options: this.options,\n      params: _babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_3___default()(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_3___default()(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_3___default()({}, defaultParams), params), {}, {\n        loginProvider: this.state.userInfo.typeOfLogin,\n        extraLoginOptions: {\n          login_hint: this.state.userInfo.verifierId\n        },\n        mfaLevel: \"mandatory\"\n      }),\n      sessionId: this.sessionId\n    };\n    const result = await this.openloginHandler(`${this.baseUrl}/start`, dataObject, getTimeout(dataObject.params.loginProvider));\n    if (this.options.uxMode === _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.UX_MODE.REDIRECT) return null;\n    if (result.error) {\n      this.dappState = result.state;\n      throw LoginError.loginFailed(result.error);\n    }\n    this.sessionManager.sessionId = result.sessionId;\n    this.options.sessionNamespace = result.sessionNamespace;\n    this.currentStorage.set(\"sessionId\", result.sessionId);\n    await this.rehydrateSession();\n    return Boolean((_this$state$userInfo = this.state.userInfo) === null || _this$state$userInfo === void 0 ? void 0 : _this$state$userInfo.isMfaEnabled);\n  }\n  async manageMFA(params) {\n    if (!this.sessionId) throw LoginError.userNotLoggedIn();\n    if (!this.state.userInfo.isMfaEnabled) throw LoginError.mfaNotEnabled();\n\n    // in case of redirect mode, redirect url will be dapp specified\n    // in case of popup mode, redirect url will be sdk specified\n    const defaultParams = {\n      redirectUrl: this.options.dashboardUrl,\n      dappUrl: `${window.location.origin}${window.location.pathname}`\n    };\n    const loginId = _toruslabs_openlogin_session_manager__WEBPACK_IMPORTED_MODULE_5__.OpenloginSessionManager.generateRandomSessionKey();\n    const dataObject = {\n      actionType: _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.OPENLOGIN_ACTIONS.MANAGE_MFA,\n      options: this.options,\n      params: _babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_3___default()(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_3___default()(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_3___default()({}, defaultParams), params), {}, {\n        loginProvider: this.state.userInfo.typeOfLogin,\n        extraLoginOptions: {\n          login_hint: this.state.userInfo.verifierId\n        },\n        appState: (0,_toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.jsonToBase64)({\n          loginId\n        })\n      }),\n      sessionId: this.sessionId\n    };\n    this.createLoginSession(loginId, dataObject, dataObject.options.sessionTime, true);\n    const configParams = {\n      loginId,\n      sessionNamespace: this.options.sessionNamespace,\n      storageServerUrl: this.options.storageServerUrl\n    };\n    const loginUrl = constructURL({\n      baseURL: `${this.baseUrl}/start`,\n      hash: {\n        b64Params: (0,_toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.jsonToBase64)(configParams)\n      }\n    });\n    window.open(loginUrl, \"_blank\");\n  }\n  async changeSocialFactor(params) {\n    if (!this.sessionId) throw LoginError.userNotLoggedIn();\n\n    // in case of redirect mode, redirect url will be dapp specified\n    // in case of popup mode, redirect url will be sdk specified\n    const defaultParams = {\n      redirectUrl: this.options.redirectUrl\n    };\n    const dataObject = {\n      actionType: _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.OPENLOGIN_ACTIONS.MODIFY_SOCIAL_FACTOR,\n      options: this.options,\n      params: _babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_3___default()(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_3___default()({}, defaultParams), params),\n      sessionId: this.sessionId\n    };\n    const result = await this.openloginHandler(`${this.baseUrl}/start`, dataObject);\n    if (this.options.uxMode === _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.UX_MODE.REDIRECT) return undefined;\n    if (result.error) return false;\n    return true;\n  }\n  getUserInfo() {\n    if (!this.sessionManager.sessionId) {\n      throw LoginError.userNotLoggedIn();\n    }\n    return this.state.userInfo;\n  }\n  async createLoginSession(loginId, data) {\n    let timeout = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 600;\n    let skipAwait = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n    if (!this.sessionManager) throw InitializationError.notInitialized();\n    const loginSessionMgr = new _toruslabs_openlogin_session_manager__WEBPACK_IMPORTED_MODULE_5__.OpenloginSessionManager({\n      sessionServerBaseUrl: data.options.storageServerUrl,\n      sessionNamespace: data.options.sessionNamespace,\n      sessionTime: timeout,\n      // each login key must be used with 10 mins (might be used at the end of popup redirect)\n      sessionId: loginId\n    });\n    const promise = loginSessionMgr.createSession(JSON.parse(JSON.stringify(data)));\n    if (data.options.uxMode === _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.UX_MODE.REDIRECT && !skipAwait) {\n      await promise;\n    }\n  }\n  async _authorizeSession() {\n    try {\n      if (!this.sessionManager.sessionId) return {};\n      const result = await this.sessionManager.authorizeSession();\n      return result;\n    } catch (err) {\n      loglevel.error(\"authorization failed\", err);\n      return {};\n    }\n  }\n  updateState(data) {\n    this.state = _babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_3___default()(_babel_runtime_helpers_objectSpread2__WEBPACK_IMPORTED_MODULE_3___default()({}, this.state), data);\n  }\n  async rehydrateSession() {\n    const result = await this._authorizeSession();\n    this.updateState(result);\n  }\n  async openloginHandler(url, dataObject) {\n    let popupTimeout = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1000 * 10;\n    const loginId = _toruslabs_openlogin_session_manager__WEBPACK_IMPORTED_MODULE_5__.OpenloginSessionManager.generateRandomSessionKey();\n    await this.createLoginSession(loginId, dataObject);\n    const configParams = {\n      loginId,\n      sessionNamespace: this.options.sessionNamespace,\n      storageServerUrl: this.options.storageServerUrl\n    };\n    if (this.options.uxMode === _toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.UX_MODE.REDIRECT) {\n      const loginUrl = constructURL({\n        baseURL: url,\n        hash: {\n          b64Params: (0,_toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.jsonToBase64)(configParams)\n        }\n      });\n      window.location.href = loginUrl;\n      return undefined;\n    }\n    const loginUrl = constructURL({\n      baseURL: url,\n      hash: {\n        b64Params: (0,_toruslabs_openlogin_utils__WEBPACK_IMPORTED_MODULE_6__.jsonToBase64)(configParams)\n      }\n    });\n    const currentWindow = new PopupHandler({\n      url: loginUrl,\n      timeout: popupTimeout\n    });\n    return new Promise((resolve, reject) => {\n      currentWindow.on(\"close\", () => {\n        reject(LoginError.popupClosed());\n      });\n      currentWindow.listenOnChannel(loginId).then(resolve).catch(reject);\n      try {\n        currentWindow.open();\n      } catch (error) {\n        reject(error);\n      }\n    });\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0B0b3J1c2xhYnMrb3BlbmxvZ2luQDguMi4xX0BiYWJlbCtydW50aW1lQDcuMjguNC9ub2RlX21vZHVsZXMvQHRvcnVzbGFicy9vcGVubG9naW4vZGlzdC9vcGVubG9naW4uZXNtLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBb0U7QUFDdEI7QUFDVDtBQUM0QjtBQUNYO0FBQ3lCO0FBQ2dIO0FBQ3RJO0FBQ25CO0FBQ2dCO0FBQ0U7QUFDNUI7O0FBRTVCLDZCQUE2Qix3REFBVztBQUN4QztBQUNBO0FBQ0E7QUFDQSxJQUFJLDRFQUFlO0FBQ25CLElBQUksNEVBQWU7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLG1DQUFtQyxJQUFJLGFBQWE7QUFDaEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsNEVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQywwQkFBMEIsSUFBSSxhQUFhO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRFQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7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Qy9CO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQix5RUFBaUI7QUFDbkM7QUFDQSxjQUFjLDJFQUFhLENBQUMsMkVBQWEsR0FBRztBQUM1QztBQUNBO0FBQ0Esa0RBQWtELGFBQWE7QUFDL0QsZ0NBQWdDLCtEQUFPO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLHlGQUF1QjtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsZ0NBQWdDLCtEQUFPO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiwyRUFBYSxDQUFDLDJFQUFhLEdBQUc7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IseUZBQXVCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQywrREFBTztBQUN2QztBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsd0VBQVk7QUFDakM7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLHdFQUFZO0FBQy9CO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFb00iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AY29sbGVjdGlibGUvd2ViLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9AdG9ydXNsYWJzK29wZW5sb2dpbkA4LjIuMV9AYmFiZWwrcnVudGltZUA3LjI4LjQvbm9kZV9tb2R1bGVzL0B0b3J1c2xhYnMvb3BlbmxvZ2luL2Rpc3Qvb3BlbmxvZ2luLmVzbS5qcz8zNDIwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAnQGJhYmVsL3J1bnRpbWUvaGVscGVycy9kZWZpbmVQcm9wZXJ0eSc7XG5pbXBvcnQgeyBDdXN0b21FcnJvciB9IGZyb20gJ3RzLWN1c3RvbS1lcnJvcic7XG5pbXBvcnQgeyBnZXRMb2dnZXIgfSBmcm9tICdsb2dsZXZlbCc7XG5pbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICdAYmFiZWwvcnVudGltZS9oZWxwZXJzL29iamVjdFNwcmVhZDInO1xuaW1wb3J0IHsgU0VTU0lPTl9TRVJWRVIgfSBmcm9tICdAdG9ydXNsYWJzL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBPcGVubG9naW5TZXNzaW9uTWFuYWdlciB9IGZyb20gJ0B0b3J1c2xhYnMvb3BlbmxvZ2luLXNlc3Npb24tbWFuYWdlcic7XG5pbXBvcnQgeyBiYXNlNjR1cmwsIHNhZmVhdG9iLCBMT0dJTl9QUk9WSURFUiwgT1BFTkxPR0lOX05FVFdPUkssIEJVSUxEX0VOViwgVE9SVVNfTEVHQUNZX05FVFdPUkssIFVYX01PREUsIEJyb3dzZXJTdG9yYWdlLCBPUEVOTE9HSU5fQUNUSU9OUywganNvblRvQmFzZTY0IH0gZnJvbSAnQHRvcnVzbGFicy9vcGVubG9naW4tdXRpbHMnO1xuaW1wb3J0IHsgU2VjdXJlUHViU3ViIH0gZnJvbSAnQHRvcnVzbGFicy9zZWN1cmUtcHViLXN1Yic7XG5pbXBvcnQgeyBFdmVudEVtaXR0ZXIgfSBmcm9tICdldmVudHMnO1xuaW1wb3J0IHsgZ2V0UHVibGljLCBzaWduIH0gZnJvbSAnQHRvcnVzbGFicy9lY2NyeXB0byc7XG5pbXBvcnQgeyBrZWNjYWsyNTYgfSBmcm9tICdAdG9ydXNsYWJzL21ldGFkYXRhLWhlbHBlcnMnO1xuaW1wb3J0IGJvd3NlciBmcm9tICdib3dzZXInO1xuXG5jbGFzcyBPcGVubG9naW5FcnJvciBleHRlbmRzIEN1c3RvbUVycm9yIHtcbiAgY29uc3RydWN0b3IoY29kZSwgbWVzc2FnZSkge1xuICAgIC8vIHRha2VzIGNhcmUgb2Ygc3RhY2sgYW5kIHByb3RvXG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwiY29kZVwiLCB2b2lkIDApO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm1lc3NhZ2VcIiwgdm9pZCAwKTtcbiAgICB0aGlzLmNvZGUgPSBjb2RlO1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2UgfHwgXCJcIjtcbiAgICAvLyBTZXQgbmFtZSBleHBsaWNpdGx5IGFzIG1pbmlmaWNhdGlvbiBjYW4gbWFuZ2xlIGNsYXNzIG5hbWVzXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibmFtZVwiLCB7XG4gICAgICB2YWx1ZTogXCJPcGVubG9naW5FcnJvclwiXG4gICAgfSk7XG4gIH1cbiAgdG9KU09OKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLm5hbWUsXG4gICAgICBjb2RlOiB0aGlzLmNvZGUsXG4gICAgICBtZXNzYWdlOiB0aGlzLm1lc3NhZ2VcbiAgICB9O1xuICB9XG4gIHRvU3RyaW5nKCkge1xuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzLnRvSlNPTigpKTtcbiAgfVxufVxuY2xhc3MgSW5pdGlhbGl6YXRpb25FcnJvciBleHRlbmRzIE9wZW5sb2dpbkVycm9yIHtcbiAgY29uc3RydWN0b3IoY29kZSwgbWVzc2FnZSkge1xuICAgIC8vIHRha2VzIGNhcmUgb2Ygc3RhY2sgYW5kIHByb3RvXG4gICAgc3VwZXIoY29kZSwgbWVzc2FnZSk7XG5cbiAgICAvLyBTZXQgbmFtZSBleHBsaWNpdGx5IGFzIG1pbmlmaWNhdGlvbiBjYW4gbWFuZ2xlIGNsYXNzIG5hbWVzXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibmFtZVwiLCB7XG4gICAgICB2YWx1ZTogXCJJbml0aWFsaXphdGlvbkVycm9yXCJcbiAgICB9KTtcbiAgfVxuICBzdGF0aWMgZnJvbUNvZGUoY29kZSkge1xuICAgIGxldCBleHRyYU1lc3NhZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IFwiXCI7XG4gICAgcmV0dXJuIG5ldyBJbml0aWFsaXphdGlvbkVycm9yKGNvZGUsIGAke0luaXRpYWxpemF0aW9uRXJyb3IubWVzc2FnZXNbY29kZV19LCAke2V4dHJhTWVzc2FnZX1gKTtcbiAgfVxuICBzdGF0aWMgaW52YWxpZFBhcmFtcygpIHtcbiAgICBsZXQgZXh0cmFNZXNzYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBcIlwiO1xuICAgIHJldHVybiBJbml0aWFsaXphdGlvbkVycm9yLmZyb21Db2RlKDUwMDEsIGV4dHJhTWVzc2FnZSk7XG4gIH1cbiAgc3RhdGljIG5vdEluaXRpYWxpemVkKCkge1xuICAgIGxldCBleHRyYU1lc3NhZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IFwiXCI7XG4gICAgcmV0dXJuIEluaXRpYWxpemF0aW9uRXJyb3IuZnJvbUNvZGUoNTAwMiwgZXh0cmFNZXNzYWdlKTtcbiAgfVxufVxuXG4vKipcbiAqIGxvZ2luIGVycm9yc1xuICovXG5fZGVmaW5lUHJvcGVydHkoSW5pdGlhbGl6YXRpb25FcnJvciwgXCJtZXNzYWdlc1wiLCB7XG4gIDUwMDA6IFwiQ3VzdG9tXCIsXG4gIDUwMDE6IFwiSW52YWxpZCBjb25zdHJ1Y3RvciBwYXJhbXNcIixcbiAgNTAwMjogXCJTREsgbm90IGluaXRpYWxpemVkLiBwbGVhc2UgY2FsbCBpbml0IGZpcnN0XCJcbn0pO1xuY2xhc3MgTG9naW5FcnJvciBleHRlbmRzIE9wZW5sb2dpbkVycm9yIHtcbiAgY29uc3RydWN0b3IoY29kZSwgbWVzc2FnZSkge1xuICAgIC8vIHRha2VzIGNhcmUgb2Ygc3RhY2sgYW5kIHByb3RvXG4gICAgc3VwZXIoY29kZSwgbWVzc2FnZSk7XG5cbiAgICAvLyBTZXQgbmFtZSBleHBsaWNpdGx5IGFzIG1pbmlmaWNhdGlvbiBjYW4gbWFuZ2xlIGNsYXNzIG5hbWVzXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibmFtZVwiLCB7XG4gICAgICB2YWx1ZTogXCJMb2dpbkVycm9yXCJcbiAgICB9KTtcbiAgfVxuICBzdGF0aWMgZnJvbUNvZGUoY29kZSkge1xuICAgIGxldCBleHRyYU1lc3NhZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IFwiXCI7XG4gICAgcmV0dXJuIG5ldyBMb2dpbkVycm9yKGNvZGUsIGAke0xvZ2luRXJyb3IubWVzc2FnZXNbY29kZV19LCAke2V4dHJhTWVzc2FnZX1gKTtcbiAgfVxuICBzdGF0aWMgaW52YWxpZExvZ2luUGFyYW1zKCkge1xuICAgIGxldCBleHRyYU1lc3NhZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IFwiXCI7XG4gICAgcmV0dXJuIExvZ2luRXJyb3IuZnJvbUNvZGUoNTExMSwgZXh0cmFNZXNzYWdlKTtcbiAgfVxuICBzdGF0aWMgdXNlck5vdExvZ2dlZEluKCkge1xuICAgIGxldCBleHRyYU1lc3NhZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IFwiXCI7XG4gICAgcmV0dXJuIExvZ2luRXJyb3IuZnJvbUNvZGUoNTExMiwgZXh0cmFNZXNzYWdlKTtcbiAgfVxuICBzdGF0aWMgcG9wdXBDbG9zZWQoKSB7XG4gICAgbGV0IGV4dHJhTWVzc2FnZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogXCJcIjtcbiAgICByZXR1cm4gTG9naW5FcnJvci5mcm9tQ29kZSg1MTEzLCBleHRyYU1lc3NhZ2UpO1xuICB9XG4gIHN0YXRpYyBsb2dpbkZhaWxlZCgpIHtcbiAgICBsZXQgZXh0cmFNZXNzYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBcIlwiO1xuICAgIHJldHVybiBMb2dpbkVycm9yLmZyb21Db2RlKDUxMTQsIGV4dHJhTWVzc2FnZSk7XG4gIH1cbiAgc3RhdGljIHBvcHVwQmxvY2tlZCgpIHtcbiAgICBsZXQgZXh0cmFNZXNzYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBcIlwiO1xuICAgIHJldHVybiBMb2dpbkVycm9yLmZyb21Db2RlKDUxMTUsIGV4dHJhTWVzc2FnZSk7XG4gIH1cbiAgc3RhdGljIG1mYUFscmVhZHlFbmFibGVkKCkge1xuICAgIGxldCBleHRyYU1lc3NhZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IFwiXCI7XG4gICAgcmV0dXJuIExvZ2luRXJyb3IuZnJvbUNvZGUoNTExNiwgZXh0cmFNZXNzYWdlKTtcbiAgfVxuICBzdGF0aWMgbWZhTm90RW5hYmxlZCgpIHtcbiAgICBsZXQgZXh0cmFNZXNzYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBcIlwiO1xuICAgIHJldHVybiBMb2dpbkVycm9yLmZyb21Db2RlKDUxMTcsIGV4dHJhTWVzc2FnZSk7XG4gIH1cbn1cbl9kZWZpbmVQcm9wZXJ0eShMb2dpbkVycm9yLCBcIm1lc3NhZ2VzXCIsIHtcbiAgNTAwMDogXCJDdXN0b21cIixcbiAgNTExMTogXCJJbnZhbGlkIGxvZ2luIHBhcmFtc1wiLFxuICA1MTEyOiBcIlVzZXIgbm90IGxvZ2dlZCBpbi5cIixcbiAgNTExMzogXCJsb2dpbiBwb3B1cCBoYXMgYmVlbiBjbG9zZWQgYnkgdGhlIHVzZXJcIixcbiAgNTExNDogXCJMb2dpbiBmYWlsZWRcIixcbiAgNTExNTogXCJQb3B1cCB3YXMgYmxvY2tlZC4gUGxlYXNlIGNhbGwgdGhpcyBmdW5jdGlvbiBhcyBzb29uIGFzIHVzZXIgY2xpY2tzIGJ1dHRvbiBvciB1c2UgcmVkaXJlY3QgbW9kZVwiLFxuICA1MTE2OiBcIk1GQSBhbHJlYWR5IGVuYWJsZWRcIixcbiAgNTExNzogXCJNRkEgbm90IHlldCBlbmFibGVkLiBQbGVhc2UgY2FsbCBgZW5hYmxlTUZBYCBmaXJzdFwiXG59KTtcblxuY29uc3QgbG9nbGV2ZWwgPSBnZXRMb2dnZXIoXCJvcGVubG9naW5cIik7XG5sb2dsZXZlbC5zZXRMZXZlbChcImVycm9yXCIpO1xuXG4vLyBkb24ndCB1c2UgZGVzdHJ1Y3R1cmluZyBmb3IgcHJvY2Vzcy5lbnYgY2F1c2UgaXQgbWVzc2VzIHVwIHdlYnBhY2sgZW52IHBsdWdpblxuY29uc3QgdmVyc2lvbiA9IFwiOC4yLjFcIjtcbmFzeW5jIGZ1bmN0aW9uIHdoaXRlbGlzdFVybChjbGllbnRJZCwgYXBwS2V5LCBvcmlnaW4pIHtcbiAgY29uc3QgYXBwS2V5QnVmID0gQnVmZmVyLmZyb20oYXBwS2V5LnBhZFN0YXJ0KDY0LCBcIjBcIiksIFwiaGV4XCIpO1xuICBpZiAoYmFzZTY0dXJsLmVuY29kZShnZXRQdWJsaWMoYXBwS2V5QnVmKSkgIT09IGNsaWVudElkKSB0aHJvdyBuZXcgRXJyb3IoXCJhcHBLZXkgbWlzbWF0Y2hcIik7XG4gIGNvbnN0IHNpZyA9IGF3YWl0IHNpZ24oYXBwS2V5QnVmLCBrZWNjYWsyNTYoQnVmZmVyLmZyb20ob3JpZ2luLCBcInV0ZjhcIikpKTtcbiAgcmV0dXJuIGJhc2U2NHVybC5lbmNvZGUoc2lnKTtcbn1cbmZ1bmN0aW9uIGdldEhhc2hRdWVyeVBhcmFtcygpIHtcbiAgbGV0IHJlcGxhY2VVcmwgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZhbHNlO1xuICBjb25zdCByZXN1bHQgPSB7fTtcbiAgY29uc3QgcXVlcnlVcmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guc2xpY2UoMSkpO1xuICBxdWVyeVVybFBhcmFtcy5mb3JFYWNoKCh2YWx1ZSwga2V5KSA9PiB7XG4gICAgaWYgKGtleSAhPT0gXCJiNjRQYXJhbXNcIikge1xuICAgICAgcmVzdWx0W2tleV0gPSB2YWx1ZTtcbiAgICB9XG4gIH0pO1xuICBjb25zdCBxdWVyeVJlc3VsdCA9IHF1ZXJ5VXJsUGFyYW1zLmdldChcImI2NFBhcmFtc1wiKTtcbiAgaWYgKHF1ZXJ5UmVzdWx0KSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHF1ZXJ5UGFyYW1zID0gSlNPTi5wYXJzZShzYWZlYXRvYihxdWVyeVJlc3VsdCkpO1xuICAgICAgT2JqZWN0LmtleXMocXVlcnlQYXJhbXMpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgcmVzdWx0W2tleV0gPSBxdWVyeVBhcmFtc1trZXldO1xuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2xldmVsLmVycm9yKGVycm9yKTtcbiAgICB9XG4gIH1cbiAgY29uc3QgaGFzaFVybFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpKTtcbiAgaGFzaFVybFBhcmFtcy5mb3JFYWNoKCh2YWx1ZSwga2V5KSA9PiB7XG4gICAgaWYgKGtleSAhPT0gXCJiNjRQYXJhbXNcIikge1xuICAgICAgcmVzdWx0W2tleV0gPSB2YWx1ZTtcbiAgICB9XG4gIH0pO1xuICBjb25zdCBoYXNoUmVzdWx0ID0gaGFzaFVybFBhcmFtcy5nZXQoXCJiNjRQYXJhbXNcIik7XG4gIGlmIChoYXNoUmVzdWx0KSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGhhc2hQYXJhbXMgPSBKU09OLnBhcnNlKHNhZmVhdG9iKGhhc2hSZXN1bHQpKTtcbiAgICAgIE9iamVjdC5rZXlzKGhhc2hQYXJhbXMpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgcmVzdWx0W2tleV0gPSBoYXNoUGFyYW1zW2tleV07XG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nbGV2ZWwuZXJyb3IoZXJyb3IpO1xuICAgIH1cbiAgfVxuICBpZiAocmVwbGFjZVVybCkge1xuICAgIGNvbnN0IGNsZWFuVXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24ub3JpZ2luICsgd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lKTtcbiAgICAvLyBodHRwczovL2RhcHAuY29tLyNiNjRQYXJhbXM9YXNhY3NkbnZkZnYmc3RhdGU9c2xkanZuZGZranZuJmRhcHBWYWx1ZT1zZGp2bmRmXG4gICAgaWYgKHF1ZXJ5VXJsUGFyYW1zLnNpemUgPiAwKSB7XG4gICAgICBxdWVyeVVybFBhcmFtcy5kZWxldGUoXCJlcnJvclwiKTtcbiAgICAgIHF1ZXJ5VXJsUGFyYW1zLmRlbGV0ZShcInN0YXRlXCIpO1xuICAgICAgcXVlcnlVcmxQYXJhbXMuZGVsZXRlKFwiYjY0UGFyYW1zXCIpO1xuICAgICAgcXVlcnlVcmxQYXJhbXMuZGVsZXRlKFwic2Vzc2lvbk5hbWVzcGFjZVwiKTtcbiAgICAgIGNsZWFuVXJsLnNlYXJjaCA9IHF1ZXJ5VXJsUGFyYW1zLnRvU3RyaW5nKCk7XG4gICAgfVxuICAgIGlmIChoYXNoVXJsUGFyYW1zLnNpemUgPiAwKSB7XG4gICAgICBoYXNoVXJsUGFyYW1zLmRlbGV0ZShcImVycm9yXCIpO1xuICAgICAgaGFzaFVybFBhcmFtcy5kZWxldGUoXCJzdGF0ZVwiKTtcbiAgICAgIGhhc2hVcmxQYXJhbXMuZGVsZXRlKFwiYjY0UGFyYW1zXCIpO1xuICAgICAgaGFzaFVybFBhcmFtcy5kZWxldGUoXCJzZXNzaW9uTmFtZXNwYWNlXCIpO1xuICAgICAgY2xlYW5VcmwuaGFzaCA9IGhhc2hVcmxQYXJhbXMudG9TdHJpbmcoKTtcbiAgICB9XG4gICAgd2luZG93Lmhpc3RvcnkucmVwbGFjZVN0YXRlKF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgd2luZG93Lmhpc3Rvcnkuc3RhdGUpLCB7fSwge1xuICAgICAgYXM6IGNsZWFuVXJsLmhyZWYsXG4gICAgICB1cmw6IGNsZWFuVXJsLmhyZWZcbiAgICB9KSwgXCJcIiwgY2xlYW5VcmwuaHJlZik7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGNvbnN0cnVjdFVSTChwYXJhbXMpIHtcbiAgY29uc3Qge1xuICAgIGJhc2VVUkwsXG4gICAgcXVlcnksXG4gICAgaGFzaFxuICB9ID0gcGFyYW1zO1xuICBjb25zdCB1cmwgPSBuZXcgVVJMKGJhc2VVUkwpO1xuICBpZiAocXVlcnkpIHtcbiAgICBPYmplY3Qua2V5cyhxdWVyeSkuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgdXJsLnNlYXJjaFBhcmFtcy5hcHBlbmQoa2V5LCBxdWVyeVtrZXldKTtcbiAgICB9KTtcbiAgfVxuICBpZiAoaGFzaCkge1xuICAgIGNvbnN0IGggPSBuZXcgVVJMKGNvbnN0cnVjdFVSTCh7XG4gICAgICBiYXNlVVJMLFxuICAgICAgcXVlcnk6IGhhc2hcbiAgICB9KSkuc2VhcmNoUGFyYW1zLnRvU3RyaW5nKCk7XG4gICAgdXJsLmhhc2ggPSBoO1xuICB9XG4gIHJldHVybiB1cmwudG9TdHJpbmcoKTtcbn1cbmZ1bmN0aW9uIGdldFBvcHVwRmVhdHVyZXMoKSB7XG4gIGlmICh0eXBlb2Ygd2luZG93ID09PSBcInVuZGVmaW5lZFwiKSByZXR1cm4gXCJcIjtcbiAgLy8gRml4ZXMgZHVhbC1zY3JlZW4gcG9zaXRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vc3QgYnJvd3NlcnMgICAgICBGaXJlZm94XG4gIGNvbnN0IGR1YWxTY3JlZW5MZWZ0ID0gd2luZG93LnNjcmVlbkxlZnQgIT09IHVuZGVmaW5lZCA/IHdpbmRvdy5zY3JlZW5MZWZ0IDogd2luZG93LnNjcmVlblg7XG4gIGNvbnN0IGR1YWxTY3JlZW5Ub3AgPSB3aW5kb3cuc2NyZWVuVG9wICE9PSB1bmRlZmluZWQgPyB3aW5kb3cuc2NyZWVuVG9wIDogd2luZG93LnNjcmVlblk7XG4gIGNvbnN0IHcgPSAxMjAwO1xuICBjb25zdCBoID0gNzAwO1xuICBjb25zdCB3aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoID8gd2luZG93LmlubmVyV2lkdGggOiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggPyBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggOiB3aW5kb3cuc2NyZWVuLndpZHRoO1xuICBjb25zdCBoZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgPyB3aW5kb3cuaW5uZXJIZWlnaHQgOiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0ID8gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCA6IHdpbmRvdy5zY3JlZW4uaGVpZ2h0O1xuICBjb25zdCBzeXN0ZW1ab29tID0gMTsgLy8gTm8gcmVsaWFibGUgZXN0aW1hdGVcblxuICBjb25zdCBsZWZ0ID0gTWF0aC5hYnMoKHdpZHRoIC0gdykgLyAyIC8gc3lzdGVtWm9vbSArIGR1YWxTY3JlZW5MZWZ0KTtcbiAgY29uc3QgdG9wID0gTWF0aC5hYnMoKGhlaWdodCAtIGgpIC8gMiAvIHN5c3RlbVpvb20gKyBkdWFsU2NyZWVuVG9wKTtcbiAgY29uc3QgZmVhdHVyZXMgPSBgdGl0bGViYXI9MCx0b29sYmFyPTAsc3RhdHVzPTAsbG9jYXRpb249MCxtZW51YmFyPTAsaGVpZ2h0PSR7aCAvIHN5c3RlbVpvb219LHdpZHRoPSR7dyAvIHN5c3RlbVpvb219LHRvcD0ke3RvcH0sbGVmdD0ke2xlZnR9YDtcbiAgcmV0dXJuIGZlYXR1cmVzO1xufVxuZnVuY3Rpb24gaXNNb2JpbGVPclRhYmxldCgpIHtcbiAgaWYgKHR5cGVvZiB3aW5kb3cgPT09IFwidW5kZWZpbmVkXCIpIHJldHVybiBmYWxzZTtcbiAgY29uc3QgYnJvd3NlciA9IGJvd3Nlci5nZXRQYXJzZXIod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpO1xuICBjb25zdCBwbGF0Zm9ybSA9IGJyb3dzZXIuZ2V0UGxhdGZvcm0oKTtcbiAgcmV0dXJuIHBsYXRmb3JtLnR5cGUgPT09IGJvd3Nlci5QTEFURk9STVNfTUFQLnRhYmxldCB8fCBwbGF0Zm9ybS50eXBlID09PSBib3dzZXIuUExBVEZPUk1TX01BUC5tb2JpbGU7XG59XG5mdW5jdGlvbiBnZXRUaW1lb3V0KGxvZ2luUHJvdmlkZXIpIHtcbiAgaWYgKChsb2dpblByb3ZpZGVyID09PSBMT0dJTl9QUk9WSURFUi5GQUNFQk9PSyB8fCBsb2dpblByb3ZpZGVyID09PSBMT0dJTl9QUk9WSURFUi5MSU5FKSAmJiBpc01vYmlsZU9yVGFibGV0KCkpIHtcbiAgICByZXR1cm4gMTAwMCAqIDYwICogNTsgLy8gNSBtaW51dGVzIHRvIGZpbmlzaCB0aGUgbG9naW5cbiAgfVxuICByZXR1cm4gMTAwMCAqIDEwOyAvLyAxMCBzZWNvbmRzXG59XG5cbmNsYXNzIFBvcHVwSGFuZGxlciBleHRlbmRzIEV2ZW50RW1pdHRlciB7XG4gIGNvbnN0cnVjdG9yKF9yZWYpIHtcbiAgICBsZXQge1xuICAgICAgdXJsLFxuICAgICAgdGFyZ2V0LFxuICAgICAgZmVhdHVyZXMsXG4gICAgICB0aW1lb3V0ID0gMzAwMDBcbiAgICB9ID0gX3JlZjtcbiAgICBzdXBlcigpO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInVybFwiLCB2b2lkIDApO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInRhcmdldFwiLCB2b2lkIDApO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImZlYXR1cmVzXCIsIHZvaWQgMCk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwid2luZG93XCIsIHZvaWQgMCk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwid2luZG93VGltZXJcIiwgdm9pZCAwKTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJpQ2xvc2VkV2luZG93XCIsIHZvaWQgMCk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwidGltZW91dFwiLCB2b2lkIDApO1xuICAgIHRoaXMudXJsID0gdXJsO1xuICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0IHx8IFwiX2JsYW5rXCI7XG4gICAgdGhpcy5mZWF0dXJlcyA9IGZlYXR1cmVzIHx8IGdldFBvcHVwRmVhdHVyZXMoKTtcbiAgICB0aGlzLndpbmRvdyA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLndpbmRvd1RpbWVyID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuaUNsb3NlZFdpbmRvdyA9IGZhbHNlO1xuICAgIHRoaXMudGltZW91dCA9IHRpbWVvdXQ7XG4gICAgdGhpcy5fc2V0dXBUaW1lcigpO1xuICB9XG4gIF9zZXR1cFRpbWVyKCkge1xuICAgIHRoaXMud2luZG93VGltZXIgPSBOdW1iZXIoc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgaWYgKHRoaXMud2luZG93ICYmIHRoaXMud2luZG93LmNsb3NlZCkge1xuICAgICAgICBjbGVhckludGVydmFsKHRoaXMud2luZG93VGltZXIpO1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBpZiAoIXRoaXMuaUNsb3NlZFdpbmRvdykge1xuICAgICAgICAgICAgdGhpcy5lbWl0KFwiY2xvc2VcIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuaUNsb3NlZFdpbmRvdyA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMud2luZG93ID0gdW5kZWZpbmVkO1xuICAgICAgICB9LCB0aGlzLnRpbWVvdXQpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMud2luZG93ID09PSB1bmRlZmluZWQpIGNsZWFySW50ZXJ2YWwodGhpcy53aW5kb3dUaW1lcik7XG4gICAgfSwgNTAwKSk7XG4gIH1cbiAgb3BlbigpIHtcbiAgICB2YXIgX3RoaXMkd2luZG93O1xuICAgIHRoaXMud2luZG93ID0gd2luZG93Lm9wZW4odGhpcy51cmwsIHRoaXMudGFyZ2V0LCB0aGlzLmZlYXR1cmVzKTtcbiAgICBpZiAoIXRoaXMud2luZG93KSB0aHJvdyBMb2dpbkVycm9yLnBvcHVwQmxvY2tlZCgpO1xuICAgIGlmICgoX3RoaXMkd2luZG93ID0gdGhpcy53aW5kb3cpICE9PSBudWxsICYmIF90aGlzJHdpbmRvdyAhPT0gdm9pZCAwICYmIF90aGlzJHdpbmRvdy5mb2N1cykgdGhpcy53aW5kb3cuZm9jdXMoKTtcbiAgfVxuICBjbG9zZSgpIHtcbiAgICB0aGlzLmlDbG9zZWRXaW5kb3cgPSB0cnVlO1xuICAgIGlmICh0aGlzLndpbmRvdykgdGhpcy53aW5kb3cuY2xvc2UoKTtcbiAgfVxuICByZWRpcmVjdChsb2NhdGlvblJlcGxhY2VPblJlZGlyZWN0KSB7XG4gICAgaWYgKGxvY2F0aW9uUmVwbGFjZU9uUmVkaXJlY3QpIHtcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKHRoaXMudXJsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB0aGlzLnVybDtcbiAgICB9XG4gIH1cbiAgYXN5bmMgbGlzdGVuT25DaGFubmVsKGxvZ2luSWQpIHtcbiAgICBjb25zdCBzZWN1cmVQdWJTdWIgPSBuZXcgU2VjdXJlUHViU3ViKCk7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHNlY3VyZVB1YlN1Yi5zdWJzY3JpYmUobG9naW5JZCk7XG4gICAgdGhpcy5jbG9zZSgpO1xuICAgIHNlY3VyZVB1YlN1Yi5jbGVhbnVwKCk7XG4gICAgY29uc3QgcGFyc2VkRGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgaWYgKHBhcnNlZERhdGEuZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGVycm9yOiBwYXJzZWREYXRhLmVycm9yLFxuICAgICAgICBzdGF0ZTogcGFyc2VkRGF0YS5zdGF0ZVxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHBhcnNlZERhdGEuZGF0YTtcbiAgfVxufVxuXG5jbGFzcyBPcGVuTG9naW4ge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwic3RhdGVcIiwge30pO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm9wdGlvbnNcIiwgdm9pZCAwKTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJzZXNzaW9uTWFuYWdlclwiLCB2b2lkIDApO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImN1cnJlbnRTdG9yYWdlXCIsIHZvaWQgMCk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwiX3N0b3JhZ2VCYXNlS2V5XCIsIFwib3BlbmxvZ2luX3N0b3JlXCIpO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImRhcHBTdGF0ZVwiLCB2b2lkIDApO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImFkZFZlcnNpb25JblVybHNcIiwgdHJ1ZSk7XG4gICAgaWYgKCFvcHRpb25zLmNsaWVudElkKSB0aHJvdyBJbml0aWFsaXphdGlvbkVycm9yLmludmFsaWRQYXJhbXMoXCJjbGllbnRJZCBpcyByZXF1aXJlZFwiKTtcbiAgICBpZiAoIW9wdGlvbnMubmV0d29yaykgb3B0aW9ucy5uZXR3b3JrID0gT1BFTkxPR0lOX05FVFdPUksuU0FQUEhJUkVfTUFJTk5FVDtcbiAgICBpZiAoIW9wdGlvbnMuYnVpbGRFbnYpIG9wdGlvbnMuYnVpbGRFbnYgPSBCVUlMRF9FTlYuUFJPRFVDVElPTjtcbiAgICBpZiAob3B0aW9ucy5idWlsZEVudiA9PT0gQlVJTERfRU5WLkRFVkVMT1BNRU5UIHx8IG9wdGlvbnMuYnVpbGRFbnYgPT09IEJVSUxEX0VOVi5URVNUSU5HIHx8IG9wdGlvbnMuc2RrVXJsKSB0aGlzLmFkZFZlcnNpb25JblVybHMgPSBmYWxzZTtcbiAgICBpZiAoIW9wdGlvbnMuc2RrVXJsICYmICFvcHRpb25zLnVzZU1wYykge1xuICAgICAgaWYgKG9wdGlvbnMuYnVpbGRFbnYgPT09IEJVSUxEX0VOVi5ERVZFTE9QTUVOVCkge1xuICAgICAgICBvcHRpb25zLnNka1VybCA9IFwiaHR0cDovL2xvY2FsaG9zdDozMDAwXCI7XG4gICAgICAgIG9wdGlvbnMuZGFzaGJvYXJkVXJsID0gXCJodHRwOi8vbG9jYWxob3N0OjUxNzMvd2FsbGV0L2FjY291bnRcIjtcbiAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5idWlsZEVudiA9PT0gQlVJTERfRU5WLlNUQUdJTkcpIHtcbiAgICAgICAgb3B0aW9ucy5zZGtVcmwgPSBcImh0dHBzOi8vc3RhZ2luZy1hdXRoLndlYjNhdXRoLmlvXCI7XG4gICAgICAgIG9wdGlvbnMuZGFzaGJvYXJkVXJsID0gXCJodHRwczovL3N0YWdpbmctYWNjb3VudC53ZWIzYXV0aC5pby93YWxsZXQvYWNjb3VudFwiO1xuICAgICAgfSBlbHNlIGlmIChvcHRpb25zLmJ1aWxkRW52ID09PSBCVUlMRF9FTlYuVEVTVElORykge1xuICAgICAgICBvcHRpb25zLnNka1VybCA9IFwiaHR0cHM6Ly9kZXZlbG9wLWF1dGgud2ViM2F1dGguaW9cIjtcbiAgICAgICAgb3B0aW9ucy5kYXNoYm9hcmRVcmwgPSBcImh0dHBzOi8vZGV2ZWxvcC1hY2NvdW50LndlYjNhdXRoLmlvL3dhbGxldC9hY2NvdW50XCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvcHRpb25zLnNka1VybCA9IFwiaHR0cHM6Ly9hdXRoLndlYjNhdXRoLmlvXCI7XG4gICAgICAgIG9wdGlvbnMuZGFzaGJvYXJkVXJsID0gXCJodHRwczovL2FjY291bnQud2ViM2F1dGguaW8vd2FsbGV0L2FjY291bnRcIjtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG9wdGlvbnMudXNlTXBjICYmICFvcHRpb25zLnNka1VybCkge1xuICAgICAgaWYgKE9iamVjdC52YWx1ZXMoVE9SVVNfTEVHQUNZX05FVFdPUkspLmluY2x1ZGVzKG9wdGlvbnMubmV0d29yaykpIHRocm93IEluaXRpYWxpemF0aW9uRXJyb3IuaW52YWxpZFBhcmFtcyhcIk1QQyBpcyBub3Qgc3VwcG9ydGVkIG9uIGxlZ2FjeSBuZXR3b3JrcywgcGxlYXNlIHVzZSBzYXBwaGlyZV9kZXZuZXQgb3Igc2FwcGhpcmVfbWFpbm5ldC5cIik7XG4gICAgICBpZiAob3B0aW9ucy5idWlsZEVudiA9PT0gQlVJTERfRU5WLkRFVkVMT1BNRU5UKSB7XG4gICAgICAgIG9wdGlvbnMuc2RrVXJsID0gXCJodHRwOi8vbG9jYWxob3N0OjMwMDBcIjtcbiAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5idWlsZEVudiA9PT0gQlVJTERfRU5WLlNUQUdJTkcpIHtcbiAgICAgICAgb3B0aW9ucy5zZGtVcmwgPSBcImh0dHBzOi8vc3RhZ2luZy1tcGMtYXV0aC53ZWIzYXV0aC5pb1wiO1xuICAgICAgfSBlbHNlIGlmIChvcHRpb25zLmJ1aWxkRW52ID09PSBCVUlMRF9FTlYuVEVTVElORykge1xuICAgICAgICBvcHRpb25zLnNka1VybCA9IFwiaHR0cHM6Ly9kZXZlbG9wLW1wYy1hdXRoLndlYjNhdXRoLmlvXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvcHRpb25zLnNka1VybCA9IFwiaHR0cHM6Ly9tcGMtYXV0aC53ZWIzYXV0aC5pb1wiO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIW9wdGlvbnMucmVkaXJlY3RVcmwgJiYgdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgb3B0aW9ucy5yZWRpcmVjdFVybCA9IGAke3dpbmRvdy5sb2NhdGlvbi5wcm90b2NvbH0vLyR7d2luZG93LmxvY2F0aW9uLmhvc3R9JHt3aW5kb3cubG9jYXRpb24ucGF0aG5hbWV9YDtcbiAgICB9XG4gICAgaWYgKCFvcHRpb25zLnV4TW9kZSkgb3B0aW9ucy51eE1vZGUgPSBVWF9NT0RFLlJFRElSRUNUO1xuICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5yZXBsYWNlVXJsT25SZWRpcmVjdCAhPT0gXCJib29sZWFuXCIpIG9wdGlvbnMucmVwbGFjZVVybE9uUmVkaXJlY3QgPSB0cnVlO1xuICAgIGlmICghb3B0aW9ucy5vcmlnaW5EYXRhKSBvcHRpb25zLm9yaWdpbkRhdGEgPSB7fTtcbiAgICBpZiAoIW9wdGlvbnMud2hpdGVMYWJlbCkgb3B0aW9ucy53aGl0ZUxhYmVsID0ge307XG4gICAgaWYgKCFvcHRpb25zLmxvZ2luQ29uZmlnKSBvcHRpb25zLmxvZ2luQ29uZmlnID0ge307XG4gICAgaWYgKCFvcHRpb25zLm1mYVNldHRpbmdzKSBvcHRpb25zLm1mYVNldHRpbmdzID0ge307XG4gICAgaWYgKCFvcHRpb25zLnN0b3JhZ2VTZXJ2ZXJVcmwpIG9wdGlvbnMuc3RvcmFnZVNlcnZlclVybCA9IFNFU1NJT05fU0VSVkVSO1xuICAgIGlmICghb3B0aW9ucy5zdG9yYWdlS2V5KSBvcHRpb25zLnN0b3JhZ2VLZXkgPSBcImxvY2FsXCI7XG4gICAgaWYgKCFvcHRpb25zLndlYmF1dGhuVHJhbnNwb3J0cykgb3B0aW9ucy53ZWJhdXRoblRyYW5zcG9ydHMgPSBbXCJpbnRlcm5hbFwiXTtcbiAgICBpZiAoIW9wdGlvbnMuc2Vzc2lvblRpbWUpIG9wdGlvbnMuc2Vzc2lvblRpbWUgPSA4NjQwMDtcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICB9XG4gIGdldCBwcml2S2V5KCkge1xuICAgIGlmICh0aGlzLm9wdGlvbnMudXNlTXBjKSByZXR1cm4gdGhpcy5zdGF0ZS5mYWN0b3JLZXkgfHwgXCJcIjtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZS5wcml2S2V5ID8gdGhpcy5zdGF0ZS5wcml2S2V5LnBhZFN0YXJ0KDY0LCBcIjBcIikgOiBcIlwiO1xuICB9XG4gIGdldCBjb3JlS2l0S2V5KCkge1xuICAgIHJldHVybiB0aGlzLnN0YXRlLmNvcmVLaXRLZXkgPyB0aGlzLnN0YXRlLmNvcmVLaXRLZXkucGFkU3RhcnQoNjQsIFwiMFwiKSA6IFwiXCI7XG4gIH1cbiAgZ2V0IGVkMjU1MTlQcml2S2V5KCkge1xuICAgIHJldHVybiB0aGlzLnN0YXRlLmVkMjU1MTlQcml2S2V5ID8gdGhpcy5zdGF0ZS5lZDI1NTE5UHJpdktleS5wYWRTdGFydCgxMjgsIFwiMFwiKSA6IFwiXCI7XG4gIH1cbiAgZ2V0IGNvcmVLaXRFZDI1NTE5S2V5KCkge1xuICAgIHJldHVybiB0aGlzLnN0YXRlLmNvcmVLaXRFZDI1NTE5UHJpdktleSA/IHRoaXMuc3RhdGUuY29yZUtpdEVkMjU1MTlQcml2S2V5LnBhZFN0YXJ0KDEyOCwgXCIwXCIpIDogXCJcIjtcbiAgfVxuICBnZXQgc2Vzc2lvbklkKCkge1xuICAgIHJldHVybiB0aGlzLnN0YXRlLnNlc3Npb25JZCB8fCBcIlwiO1xuICB9XG4gIGdldCBzZXNzaW9uTmFtZXNwYWNlKCkge1xuICAgIHJldHVybiB0aGlzLm9wdGlvbnMuc2Vzc2lvbk5hbWVzcGFjZSB8fCBcIlwiO1xuICB9XG4gIGdldCBhcHBTdGF0ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZS51c2VySW5mby5hcHBTdGF0ZSB8fCB0aGlzLmRhcHBTdGF0ZSB8fCBcIlwiO1xuICB9XG4gIGdldCBiYXNlVXJsKCkge1xuICAgIC8vIHRlc3RpbmcgYW5kIGRldmVsb3AgZG9uJ3QgaGF2ZSB2ZXJzaW9uaW5nXG4gICAgaWYgKCF0aGlzLmFkZFZlcnNpb25JblVybHMpIHJldHVybiBgJHt0aGlzLm9wdGlvbnMuc2RrVXJsfWA7XG4gICAgcmV0dXJuIGAke3RoaXMub3B0aW9ucy5zZGtVcmx9L3Yke3ZlcnNpb24uc3BsaXQoXCIuXCIpWzBdfWA7XG4gIH1cbiAgYXN5bmMgaW5pdCgpIHtcbiAgICAvLyBnZXQgc2Vzc2lvbk5hbWVzcGFjZSBmcm9tIHRoZSByZWRpcmVjdCByZXN1bHQuXG4gICAgY29uc3QgcGFyYW1zID0gZ2V0SGFzaFF1ZXJ5UGFyYW1zKHRoaXMub3B0aW9ucy5yZXBsYWNlVXJsT25SZWRpcmVjdCk7XG4gICAgaWYgKHBhcmFtcy5zZXNzaW9uTmFtZXNwYWNlKSB0aGlzLm9wdGlvbnMuc2Vzc2lvbk5hbWVzcGFjZSA9IHBhcmFtcy5zZXNzaW9uTmFtZXNwYWNlO1xuICAgIGNvbnN0IHN0b3JhZ2VLZXkgPSB0aGlzLm9wdGlvbnMuc2Vzc2lvbk5hbWVzcGFjZSA/IGAke3RoaXMuX3N0b3JhZ2VCYXNlS2V5fV8ke3RoaXMub3B0aW9ucy5zZXNzaW9uTmFtZXNwYWNlfWAgOiB0aGlzLl9zdG9yYWdlQmFzZUtleTtcbiAgICB0aGlzLmN1cnJlbnRTdG9yYWdlID0gQnJvd3NlclN0b3JhZ2UuZ2V0SW5zdGFuY2Uoc3RvcmFnZUtleSwgdGhpcy5vcHRpb25zLnN0b3JhZ2VLZXkpO1xuICAgIGNvbnN0IHNlc3Npb25JZCA9IHRoaXMuY3VycmVudFN0b3JhZ2UuZ2V0KFwic2Vzc2lvbklkXCIpO1xuICAgIHRoaXMuc2Vzc2lvbk1hbmFnZXIgPSBuZXcgT3BlbmxvZ2luU2Vzc2lvbk1hbmFnZXIoe1xuICAgICAgc2Vzc2lvblNlcnZlckJhc2VVcmw6IHRoaXMub3B0aW9ucy5zdG9yYWdlU2VydmVyVXJsLFxuICAgICAgc2Vzc2lvbk5hbWVzcGFjZTogdGhpcy5vcHRpb25zLnNlc3Npb25OYW1lc3BhY2UsXG4gICAgICBzZXNzaW9uVGltZTogdGhpcy5vcHRpb25zLnNlc3Npb25UaW1lLFxuICAgICAgc2Vzc2lvbklkXG4gICAgfSk7XG4gICAgaWYgKHRoaXMub3B0aW9ucy5uZXR3b3JrID09PSBPUEVOTE9HSU5fTkVUV09SSy5URVNUTkVUIHx8IHRoaXMub3B0aW9ucy5uZXR3b3JrID09PSBPUEVOTE9HSU5fTkVUV09SSy5TQVBQSElSRV9ERVZORVQpIHtcbiAgICAgIC8vIHVzaW5nIGNvbnNvbGUgbG9nIGJlY2F1c2UgaXQgc2hvdWxkbid0IGJlIGFmZmVjdGVkIGJ5IGxvZ2xldmVsIGNvbmZpZ1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgIGNvbnNvbGUubG9nKGAlYyBXQVJOSU5HISBZb3UgYXJlIG9uICR7dGhpcy5vcHRpb25zLm5ldHdvcmt9LiBQbGVhc2Ugc2V0IG5ldHdvcms6ICdtYWlubmV0JyBvciAnc2FwcGhpcmVfbWFpbm5ldCcgaW4gcHJvZHVjdGlvbmAsIFwiY29sb3I6ICNGRjAwMDBcIik7XG4gICAgfVxuICAgIGlmICh0aGlzLm9wdGlvbnMuYnVpbGRFbnYgIT09IEJVSUxEX0VOVi5QUk9EVUNUSU9OKSB7XG4gICAgICAvLyB1c2luZyBjb25zb2xlIGxvZyBiZWNhdXNlIGl0IHNob3VsZG4ndCBiZSBhZmZlY3RlZCBieSBsb2dsZXZlbCBjb25maWdcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICBjb25zb2xlLmxvZyhgJWMgV0FSTklORyEgWW91IGFyZSB1c2luZyBidWlsZCBlbnYgJHt0aGlzLm9wdGlvbnMuYnVpbGRFbnZ9LiBQbGVhc2Ugc2V0IGJ1aWxkRW52OiAncHJvZHVjdGlvbicgaW4gcHJvZHVjdGlvbmAsIFwiY29sb3I6ICNGRjAwMDBcIik7XG4gICAgfVxuICAgIGlmIChwYXJhbXMuZXJyb3IpIHtcbiAgICAgIHRoaXMuZGFwcFN0YXRlID0gcGFyYW1zLnN0YXRlO1xuICAgICAgdGhyb3cgTG9naW5FcnJvci5sb2dpbkZhaWxlZChwYXJhbXMuZXJyb3IpO1xuICAgIH1cbiAgICBpZiAocGFyYW1zLnNlc3Npb25JZCkge1xuICAgICAgdGhpcy5jdXJyZW50U3RvcmFnZS5zZXQoXCJzZXNzaW9uSWRcIiwgcGFyYW1zLnNlc3Npb25JZCk7XG4gICAgICB0aGlzLnNlc3Npb25NYW5hZ2VyLnNlc3Npb25JZCA9IHBhcmFtcy5zZXNzaW9uSWQ7XG4gICAgfVxuICAgIGlmICh0aGlzLnNlc3Npb25NYW5hZ2VyLnNlc3Npb25JZCkge1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuX2F1dGhvcml6ZVNlc3Npb24oKTtcbiAgICAgIC8vIEZpbGwgc3RhdGUgd2l0aCBjb3JyZWN0IGluZm8gZnJvbSBzZXNzaW9uXG4gICAgICAvLyBJZiBzZXNzaW9uIGlzIGludmFsaWQgYWxsIHRoZSBkYXRhIGlzIHVuc2V0IGhlcmUuXG4gICAgICB0aGlzLnVwZGF0ZVN0YXRlKGRhdGEpO1xuICAgICAgaWYgKE9iamVjdC5rZXlzKGRhdGEpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAvLyBJZiBzZXNzaW9uIGlzIGludmFsaWQsIHVuc2V0IHRoZSBzZXNzaW9uSWQgZnJvbSBsb2NhbFN0b3JhZ2UuXG4gICAgICAgIHRoaXMuY3VycmVudFN0b3JhZ2Uuc2V0KFwic2Vzc2lvbklkXCIsIFwiXCIpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBhc3luYyBsb2dpbihwYXJhbXMpIHtcbiAgICBpZiAoIXBhcmFtcy5sb2dpblByb3ZpZGVyKSB0aHJvdyBMb2dpbkVycm9yLmludmFsaWRMb2dpblBhcmFtcyhgbG9naW5Qcm92aWRlciBpcyByZXF1aXJlZGApO1xuXG4gICAgLy8gaW4gY2FzZSBvZiByZWRpcmVjdCBtb2RlLCByZWRpcmVjdCB1cmwgd2lsbCBiZSBkYXBwIHNwZWNpZmllZFxuICAgIC8vIGluIGNhc2Ugb2YgcG9wdXAgbW9kZSwgcmVkaXJlY3QgdXJsIHdpbGwgYmUgc2RrIHNwZWNpZmllZFxuICAgIGNvbnN0IGRlZmF1bHRQYXJhbXMgPSB7XG4gICAgICByZWRpcmVjdFVybDogdGhpcy5vcHRpb25zLnJlZGlyZWN0VXJsXG4gICAgfTtcbiAgICBjb25zdCBsb2dpblBhcmFtcyA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7XG4gICAgICBsb2dpblByb3ZpZGVyOiBwYXJhbXMubG9naW5Qcm92aWRlclxuICAgIH0sIGRlZmF1bHRQYXJhbXMpLCBwYXJhbXMpO1xuICAgIGNvbnN0IGRhdGFPYmplY3QgPSB7XG4gICAgICBhY3Rpb25UeXBlOiBPUEVOTE9HSU5fQUNUSU9OUy5MT0dJTixcbiAgICAgIG9wdGlvbnM6IHRoaXMub3B0aW9ucyxcbiAgICAgIHBhcmFtczogbG9naW5QYXJhbXNcbiAgICB9O1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMub3BlbmxvZ2luSGFuZGxlcihgJHt0aGlzLmJhc2VVcmx9L3N0YXJ0YCwgZGF0YU9iamVjdCwgZ2V0VGltZW91dChwYXJhbXMubG9naW5Qcm92aWRlcikpO1xuICAgIGlmICh0aGlzLm9wdGlvbnMudXhNb2RlID09PSBVWF9NT0RFLlJFRElSRUNUKSByZXR1cm4gbnVsbDtcbiAgICBpZiAocmVzdWx0LmVycm9yKSB7XG4gICAgICB0aGlzLmRhcHBTdGF0ZSA9IHJlc3VsdC5zdGF0ZTtcbiAgICAgIHRocm93IExvZ2luRXJyb3IubG9naW5GYWlsZWQocmVzdWx0LmVycm9yKTtcbiAgICB9XG4gICAgdGhpcy5zZXNzaW9uTWFuYWdlci5zZXNzaW9uSWQgPSByZXN1bHQuc2Vzc2lvbklkO1xuICAgIHRoaXMub3B0aW9ucy5zZXNzaW9uTmFtZXNwYWNlID0gcmVzdWx0LnNlc3Npb25OYW1lc3BhY2U7XG4gICAgdGhpcy5jdXJyZW50U3RvcmFnZS5zZXQoXCJzZXNzaW9uSWRcIiwgcmVzdWx0LnNlc3Npb25JZCk7XG4gICAgYXdhaXQgdGhpcy5yZWh5ZHJhdGVTZXNzaW9uKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHByaXZLZXk6IHRoaXMucHJpdktleVxuICAgIH07XG4gIH1cbiAgYXN5bmMgbG9nb3V0KCkge1xuICAgIGlmICghdGhpcy5zZXNzaW9uTWFuYWdlci5zZXNzaW9uSWQpIHRocm93IExvZ2luRXJyb3IudXNlck5vdExvZ2dlZEluKCk7XG4gICAgYXdhaXQgdGhpcy5zZXNzaW9uTWFuYWdlci5pbnZhbGlkYXRlU2Vzc2lvbigpO1xuICAgIHRoaXMudXBkYXRlU3RhdGUoe1xuICAgICAgcHJpdktleTogXCJcIixcbiAgICAgIGNvcmVLaXRLZXk6IFwiXCIsXG4gICAgICBjb3JlS2l0RWQyNTUxOVByaXZLZXk6IFwiXCIsXG4gICAgICBlZDI1NTE5UHJpdktleTogXCJcIixcbiAgICAgIHdhbGxldEtleTogXCJcIixcbiAgICAgIG9BdXRoUHJpdmF0ZUtleTogXCJcIixcbiAgICAgIHRLZXk6IFwiXCIsXG4gICAgICBtZXRhZGF0YU5vbmNlOiBcIlwiLFxuICAgICAga2V5TW9kZTogdW5kZWZpbmVkLFxuICAgICAgdXNlckluZm86IHtcbiAgICAgICAgbmFtZTogXCJcIixcbiAgICAgICAgcHJvZmlsZUltYWdlOiBcIlwiLFxuICAgICAgICBkYXBwU2hhcmU6IFwiXCIsXG4gICAgICAgIGlkVG9rZW46IFwiXCIsXG4gICAgICAgIG9BdXRoSWRUb2tlbjogXCJcIixcbiAgICAgICAgb0F1dGhBY2Nlc3NUb2tlbjogXCJcIixcbiAgICAgICAgYXBwU3RhdGU6IFwiXCIsXG4gICAgICAgIGVtYWlsOiBcIlwiLFxuICAgICAgICB2ZXJpZmllcjogXCJcIixcbiAgICAgICAgdmVyaWZpZXJJZDogXCJcIixcbiAgICAgICAgYWdncmVnYXRlVmVyaWZpZXI6IFwiXCIsXG4gICAgICAgIHR5cGVPZkxvZ2luOiBcIlwiLFxuICAgICAgICBpc01mYUVuYWJsZWQ6IGZhbHNlXG4gICAgICB9LFxuICAgICAgYXV0aFRva2VuOiBcIlwiLFxuICAgICAgc2Vzc2lvbklkOiBcIlwiLFxuICAgICAgZmFjdG9yS2V5OiBcIlwiLFxuICAgICAgc2lnbmF0dXJlczogW10sXG4gICAgICB0c3NTaGFyZUluZGV4OiAtMSxcbiAgICAgIHRzc1B1YktleTogXCJcIixcbiAgICAgIHRzc1NoYXJlOiBcIlwiLFxuICAgICAgdHNzTm9uY2U6IC0xXG4gICAgfSk7XG4gICAgdGhpcy5jdXJyZW50U3RvcmFnZS5zZXQoXCJzZXNzaW9uSWRcIiwgXCJcIik7XG4gIH1cbiAgYXN5bmMgZW5hYmxlTUZBKHBhcmFtcykge1xuICAgIHZhciBfdGhpcyRzdGF0ZSR1c2VySW5mbztcbiAgICBpZiAoIXRoaXMuc2Vzc2lvbklkKSB0aHJvdyBMb2dpbkVycm9yLnVzZXJOb3RMb2dnZWRJbigpO1xuICAgIGlmICh0aGlzLnN0YXRlLnVzZXJJbmZvLmlzTWZhRW5hYmxlZCkgdGhyb3cgTG9naW5FcnJvci5tZmFBbHJlYWR5RW5hYmxlZCgpO1xuICAgIC8vIGluIGNhc2Ugb2YgcmVkaXJlY3QgbW9kZSwgcmVkaXJlY3QgdXJsIHdpbGwgYmUgZGFwcCBzcGVjaWZpZWRcbiAgICAvLyBpbiBjYXNlIG9mIHBvcHVwIG1vZGUsIHJlZGlyZWN0IHVybCB3aWxsIGJlIHNkayBzcGVjaWZpZWRcbiAgICBjb25zdCBkZWZhdWx0UGFyYW1zID0ge1xuICAgICAgcmVkaXJlY3RVcmw6IHRoaXMub3B0aW9ucy5yZWRpcmVjdFVybFxuICAgIH07XG4gICAgY29uc3QgZGF0YU9iamVjdCA9IHtcbiAgICAgIGFjdGlvblR5cGU6IE9QRU5MT0dJTl9BQ1RJT05TLkVOQUJMRV9NRkEsXG4gICAgICBvcHRpb25zOiB0aGlzLm9wdGlvbnMsXG4gICAgICBwYXJhbXM6IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBkZWZhdWx0UGFyYW1zKSwgcGFyYW1zKSwge30sIHtcbiAgICAgICAgbG9naW5Qcm92aWRlcjogdGhpcy5zdGF0ZS51c2VySW5mby50eXBlT2ZMb2dpbixcbiAgICAgICAgZXh0cmFMb2dpbk9wdGlvbnM6IHtcbiAgICAgICAgICBsb2dpbl9oaW50OiB0aGlzLnN0YXRlLnVzZXJJbmZvLnZlcmlmaWVySWRcbiAgICAgICAgfSxcbiAgICAgICAgbWZhTGV2ZWw6IFwibWFuZGF0b3J5XCJcbiAgICAgIH0pLFxuICAgICAgc2Vzc2lvbklkOiB0aGlzLnNlc3Npb25JZFxuICAgIH07XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5vcGVubG9naW5IYW5kbGVyKGAke3RoaXMuYmFzZVVybH0vc3RhcnRgLCBkYXRhT2JqZWN0LCBnZXRUaW1lb3V0KGRhdGFPYmplY3QucGFyYW1zLmxvZ2luUHJvdmlkZXIpKTtcbiAgICBpZiAodGhpcy5vcHRpb25zLnV4TW9kZSA9PT0gVVhfTU9ERS5SRURJUkVDVCkgcmV0dXJuIG51bGw7XG4gICAgaWYgKHJlc3VsdC5lcnJvcikge1xuICAgICAgdGhpcy5kYXBwU3RhdGUgPSByZXN1bHQuc3RhdGU7XG4gICAgICB0aHJvdyBMb2dpbkVycm9yLmxvZ2luRmFpbGVkKHJlc3VsdC5lcnJvcik7XG4gICAgfVxuICAgIHRoaXMuc2Vzc2lvbk1hbmFnZXIuc2Vzc2lvbklkID0gcmVzdWx0LnNlc3Npb25JZDtcbiAgICB0aGlzLm9wdGlvbnMuc2Vzc2lvbk5hbWVzcGFjZSA9IHJlc3VsdC5zZXNzaW9uTmFtZXNwYWNlO1xuICAgIHRoaXMuY3VycmVudFN0b3JhZ2Uuc2V0KFwic2Vzc2lvbklkXCIsIHJlc3VsdC5zZXNzaW9uSWQpO1xuICAgIGF3YWl0IHRoaXMucmVoeWRyYXRlU2Vzc2lvbigpO1xuICAgIHJldHVybiBCb29sZWFuKChfdGhpcyRzdGF0ZSR1c2VySW5mbyA9IHRoaXMuc3RhdGUudXNlckluZm8pID09PSBudWxsIHx8IF90aGlzJHN0YXRlJHVzZXJJbmZvID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRzdGF0ZSR1c2VySW5mby5pc01mYUVuYWJsZWQpO1xuICB9XG4gIGFzeW5jIG1hbmFnZU1GQShwYXJhbXMpIHtcbiAgICBpZiAoIXRoaXMuc2Vzc2lvbklkKSB0aHJvdyBMb2dpbkVycm9yLnVzZXJOb3RMb2dnZWRJbigpO1xuICAgIGlmICghdGhpcy5zdGF0ZS51c2VySW5mby5pc01mYUVuYWJsZWQpIHRocm93IExvZ2luRXJyb3IubWZhTm90RW5hYmxlZCgpO1xuXG4gICAgLy8gaW4gY2FzZSBvZiByZWRpcmVjdCBtb2RlLCByZWRpcmVjdCB1cmwgd2lsbCBiZSBkYXBwIHNwZWNpZmllZFxuICAgIC8vIGluIGNhc2Ugb2YgcG9wdXAgbW9kZSwgcmVkaXJlY3QgdXJsIHdpbGwgYmUgc2RrIHNwZWNpZmllZFxuICAgIGNvbnN0IGRlZmF1bHRQYXJhbXMgPSB7XG4gICAgICByZWRpcmVjdFVybDogdGhpcy5vcHRpb25zLmRhc2hib2FyZFVybCxcbiAgICAgIGRhcHBVcmw6IGAke3dpbmRvdy5sb2NhdGlvbi5vcmlnaW59JHt3aW5kb3cubG9jYXRpb24ucGF0aG5hbWV9YFxuICAgIH07XG4gICAgY29uc3QgbG9naW5JZCA9IE9wZW5sb2dpblNlc3Npb25NYW5hZ2VyLmdlbmVyYXRlUmFuZG9tU2Vzc2lvbktleSgpO1xuICAgIGNvbnN0IGRhdGFPYmplY3QgPSB7XG4gICAgICBhY3Rpb25UeXBlOiBPUEVOTE9HSU5fQUNUSU9OUy5NQU5BR0VfTUZBLFxuICAgICAgb3B0aW9uczogdGhpcy5vcHRpb25zLFxuICAgICAgcGFyYW1zOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgZGVmYXVsdFBhcmFtcyksIHBhcmFtcyksIHt9LCB7XG4gICAgICAgIGxvZ2luUHJvdmlkZXI6IHRoaXMuc3RhdGUudXNlckluZm8udHlwZU9mTG9naW4sXG4gICAgICAgIGV4dHJhTG9naW5PcHRpb25zOiB7XG4gICAgICAgICAgbG9naW5faGludDogdGhpcy5zdGF0ZS51c2VySW5mby52ZXJpZmllcklkXG4gICAgICAgIH0sXG4gICAgICAgIGFwcFN0YXRlOiBqc29uVG9CYXNlNjQoe1xuICAgICAgICAgIGxvZ2luSWRcbiAgICAgICAgfSlcbiAgICAgIH0pLFxuICAgICAgc2Vzc2lvbklkOiB0aGlzLnNlc3Npb25JZFxuICAgIH07XG4gICAgdGhpcy5jcmVhdGVMb2dpblNlc3Npb24obG9naW5JZCwgZGF0YU9iamVjdCwgZGF0YU9iamVjdC5vcHRpb25zLnNlc3Npb25UaW1lLCB0cnVlKTtcbiAgICBjb25zdCBjb25maWdQYXJhbXMgPSB7XG4gICAgICBsb2dpbklkLFxuICAgICAgc2Vzc2lvbk5hbWVzcGFjZTogdGhpcy5vcHRpb25zLnNlc3Npb25OYW1lc3BhY2UsXG4gICAgICBzdG9yYWdlU2VydmVyVXJsOiB0aGlzLm9wdGlvbnMuc3RvcmFnZVNlcnZlclVybFxuICAgIH07XG4gICAgY29uc3QgbG9naW5VcmwgPSBjb25zdHJ1Y3RVUkwoe1xuICAgICAgYmFzZVVSTDogYCR7dGhpcy5iYXNlVXJsfS9zdGFydGAsXG4gICAgICBoYXNoOiB7XG4gICAgICAgIGI2NFBhcmFtczoganNvblRvQmFzZTY0KGNvbmZpZ1BhcmFtcylcbiAgICAgIH1cbiAgICB9KTtcbiAgICB3aW5kb3cub3Blbihsb2dpblVybCwgXCJfYmxhbmtcIik7XG4gIH1cbiAgYXN5bmMgY2hhbmdlU29jaWFsRmFjdG9yKHBhcmFtcykge1xuICAgIGlmICghdGhpcy5zZXNzaW9uSWQpIHRocm93IExvZ2luRXJyb3IudXNlck5vdExvZ2dlZEluKCk7XG5cbiAgICAvLyBpbiBjYXNlIG9mIHJlZGlyZWN0IG1vZGUsIHJlZGlyZWN0IHVybCB3aWxsIGJlIGRhcHAgc3BlY2lmaWVkXG4gICAgLy8gaW4gY2FzZSBvZiBwb3B1cCBtb2RlLCByZWRpcmVjdCB1cmwgd2lsbCBiZSBzZGsgc3BlY2lmaWVkXG4gICAgY29uc3QgZGVmYXVsdFBhcmFtcyA9IHtcbiAgICAgIHJlZGlyZWN0VXJsOiB0aGlzLm9wdGlvbnMucmVkaXJlY3RVcmxcbiAgICB9O1xuICAgIGNvbnN0IGRhdGFPYmplY3QgPSB7XG4gICAgICBhY3Rpb25UeXBlOiBPUEVOTE9HSU5fQUNUSU9OUy5NT0RJRllfU09DSUFMX0ZBQ1RPUixcbiAgICAgIG9wdGlvbnM6IHRoaXMub3B0aW9ucyxcbiAgICAgIHBhcmFtczogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBkZWZhdWx0UGFyYW1zKSwgcGFyYW1zKSxcbiAgICAgIHNlc3Npb25JZDogdGhpcy5zZXNzaW9uSWRcbiAgICB9O1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMub3BlbmxvZ2luSGFuZGxlcihgJHt0aGlzLmJhc2VVcmx9L3N0YXJ0YCwgZGF0YU9iamVjdCk7XG4gICAgaWYgKHRoaXMub3B0aW9ucy51eE1vZGUgPT09IFVYX01PREUuUkVESVJFQ1QpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgaWYgKHJlc3VsdC5lcnJvcikgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGdldFVzZXJJbmZvKCkge1xuICAgIGlmICghdGhpcy5zZXNzaW9uTWFuYWdlci5zZXNzaW9uSWQpIHtcbiAgICAgIHRocm93IExvZ2luRXJyb3IudXNlck5vdExvZ2dlZEluKCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnN0YXRlLnVzZXJJbmZvO1xuICB9XG4gIGFzeW5jIGNyZWF0ZUxvZ2luU2Vzc2lvbihsb2dpbklkLCBkYXRhKSB7XG4gICAgbGV0IHRpbWVvdXQgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IDYwMDtcbiAgICBsZXQgc2tpcEF3YWl0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmYWxzZTtcbiAgICBpZiAoIXRoaXMuc2Vzc2lvbk1hbmFnZXIpIHRocm93IEluaXRpYWxpemF0aW9uRXJyb3Iubm90SW5pdGlhbGl6ZWQoKTtcbiAgICBjb25zdCBsb2dpblNlc3Npb25NZ3IgPSBuZXcgT3BlbmxvZ2luU2Vzc2lvbk1hbmFnZXIoe1xuICAgICAgc2Vzc2lvblNlcnZlckJhc2VVcmw6IGRhdGEub3B0aW9ucy5zdG9yYWdlU2VydmVyVXJsLFxuICAgICAgc2Vzc2lvbk5hbWVzcGFjZTogZGF0YS5vcHRpb25zLnNlc3Npb25OYW1lc3BhY2UsXG4gICAgICBzZXNzaW9uVGltZTogdGltZW91dCxcbiAgICAgIC8vIGVhY2ggbG9naW4ga2V5IG11c3QgYmUgdXNlZCB3aXRoIDEwIG1pbnMgKG1pZ2h0IGJlIHVzZWQgYXQgdGhlIGVuZCBvZiBwb3B1cCByZWRpcmVjdClcbiAgICAgIHNlc3Npb25JZDogbG9naW5JZFxuICAgIH0pO1xuICAgIGNvbnN0IHByb21pc2UgPSBsb2dpblNlc3Npb25NZ3IuY3JlYXRlU2Vzc2lvbihKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRhdGEpKSk7XG4gICAgaWYgKGRhdGEub3B0aW9ucy51eE1vZGUgPT09IFVYX01PREUuUkVESVJFQ1QgJiYgIXNraXBBd2FpdCkge1xuICAgICAgYXdhaXQgcHJvbWlzZTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgX2F1dGhvcml6ZVNlc3Npb24oKSB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICghdGhpcy5zZXNzaW9uTWFuYWdlci5zZXNzaW9uSWQpIHJldHVybiB7fTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuc2Vzc2lvbk1hbmFnZXIuYXV0aG9yaXplU2Vzc2lvbigpO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGxvZ2xldmVsLmVycm9yKFwiYXV0aG9yaXphdGlvbiBmYWlsZWRcIiwgZXJyKTtcbiAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gIH1cbiAgdXBkYXRlU3RhdGUoZGF0YSkge1xuICAgIHRoaXMuc3RhdGUgPSBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHRoaXMuc3RhdGUpLCBkYXRhKTtcbiAgfVxuICBhc3luYyByZWh5ZHJhdGVTZXNzaW9uKCkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuX2F1dGhvcml6ZVNlc3Npb24oKTtcbiAgICB0aGlzLnVwZGF0ZVN0YXRlKHJlc3VsdCk7XG4gIH1cbiAgYXN5bmMgb3BlbmxvZ2luSGFuZGxlcih1cmwsIGRhdGFPYmplY3QpIHtcbiAgICBsZXQgcG9wdXBUaW1lb3V0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiAxMDAwICogMTA7XG4gICAgY29uc3QgbG9naW5JZCA9IE9wZW5sb2dpblNlc3Npb25NYW5hZ2VyLmdlbmVyYXRlUmFuZG9tU2Vzc2lvbktleSgpO1xuICAgIGF3YWl0IHRoaXMuY3JlYXRlTG9naW5TZXNzaW9uKGxvZ2luSWQsIGRhdGFPYmplY3QpO1xuICAgIGNvbnN0IGNvbmZpZ1BhcmFtcyA9IHtcbiAgICAgIGxvZ2luSWQsXG4gICAgICBzZXNzaW9uTmFtZXNwYWNlOiB0aGlzLm9wdGlvbnMuc2Vzc2lvbk5hbWVzcGFjZSxcbiAgICAgIHN0b3JhZ2VTZXJ2ZXJVcmw6IHRoaXMub3B0aW9ucy5zdG9yYWdlU2VydmVyVXJsXG4gICAgfTtcbiAgICBpZiAodGhpcy5vcHRpb25zLnV4TW9kZSA9PT0gVVhfTU9ERS5SRURJUkVDVCkge1xuICAgICAgY29uc3QgbG9naW5VcmwgPSBjb25zdHJ1Y3RVUkwoe1xuICAgICAgICBiYXNlVVJMOiB1cmwsXG4gICAgICAgIGhhc2g6IHtcbiAgICAgICAgICBiNjRQYXJhbXM6IGpzb25Ub0Jhc2U2NChjb25maWdQYXJhbXMpXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBsb2dpblVybDtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGNvbnN0IGxvZ2luVXJsID0gY29uc3RydWN0VVJMKHtcbiAgICAgIGJhc2VVUkw6IHVybCxcbiAgICAgIGhhc2g6IHtcbiAgICAgICAgYjY0UGFyYW1zOiBqc29uVG9CYXNlNjQoY29uZmlnUGFyYW1zKVxuICAgICAgfVxuICAgIH0pO1xuICAgIGNvbnN0IGN1cnJlbnRXaW5kb3cgPSBuZXcgUG9wdXBIYW5kbGVyKHtcbiAgICAgIHVybDogbG9naW5VcmwsXG4gICAgICB0aW1lb3V0OiBwb3B1cFRpbWVvdXRcbiAgICB9KTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgY3VycmVudFdpbmRvdy5vbihcImNsb3NlXCIsICgpID0+IHtcbiAgICAgICAgcmVqZWN0KExvZ2luRXJyb3IucG9wdXBDbG9zZWQoKSk7XG4gICAgICB9KTtcbiAgICAgIGN1cnJlbnRXaW5kb3cubGlzdGVuT25DaGFubmVsKGxvZ2luSWQpLnRoZW4ocmVzb2x2ZSkuY2F0Y2gocmVqZWN0KTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGN1cnJlbnRXaW5kb3cub3BlbigpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgeyBJbml0aWFsaXphdGlvbkVycm9yLCBMb2dpbkVycm9yLCBPcGVubG9naW5FcnJvciwgY29uc3RydWN0VVJMLCBPcGVuTG9naW4gYXMgZGVmYXVsdCwgZ2V0SGFzaFF1ZXJ5UGFyYW1zLCBnZXRQb3B1cEZlYXR1cmVzLCBnZXRUaW1lb3V0LCBpc01vYmlsZU9yVGFibGV0LCBsb2dsZXZlbCwgdmVyc2lvbiwgd2hpdGVsaXN0VXJsIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/../../node_modules/.pnpm/@toruslabs+openlogin@8.2.1_@babel+runtime@7.28.4/node_modules/@toruslabs/openlogin/dist/openlogin.esm.js\n");

/***/ })

};
;